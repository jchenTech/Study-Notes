## 1 插值

> **定义**：设函数 $y=f(x)$ 在区间[a, b]上的 $n + 1$ 个点， $a \le x_0,x_1,...,x_n \le b$ 上的函数值为 $y_0,y_1,...,y_n$ 若存在函数 $P(x)$ ， 使得：
> $$
P(x_i)=y_i,i=0,1,...,n
> $$
> 成立，则称函数 $P(x)$ 为 $f(x)$的**插值函数**，$f(x)$ 称为被插值函数，点 $x_0,x_1,...,x_n$ 称为插值节点，包含插值节点的区间[a, b] 称为插值区间。

一般来说 $P(x)$ 分为三类，一类是 $n$ 次多项式 $a_0 + a_1 x + ... + a_n x_n$，一类是三角多项式，最后一类是分段 $n$ 次多项式。

## 2 多项式插值

- 插值多项式是否存在，若存在是否唯一
- 怎么推导插值多项式
- 如何应用

这个可以说是最简单的插值了。由插值条件可得：
$$
\left\{ \begin{array}{l}
{a_0} + {a_1}{x_0} + a{}_2x_0^2 +  \cdots  + {a_n}x_0^n = {y_0}\\
{a_0} + {a_1}{x_1} + a{}_2x_1^2 +  \cdots  + {a_n}x_1^n = {y_1}\\
 \vdots \\
{a_0} + {a_1}{x_n} + {a_2}x_n^2 +  \cdots  + {a_n}x_n^n = {y_n}
\end{array} \right.
$$
这是一个关于 ${a_0},{a_1} \cdots {a_n}$ 的 $n+1$ 元线性方程组。

证明插值多项式的存在唯一性：上述线性方程组的系数行列式为Vandermond行列式，计算过程为：
$$
{V_n}({x_0},{x_1}, \cdots ,{x_n}) = \left| {\begin{array}{*{20}{c}}
1&{{x_0}}&{x_0^2}& \cdots &{x_0^n}\\
1&{{x_1}}&{x_1^2}& \cdots &{x_1^n}\\
 \cdots & \cdots & \cdots & \cdots & \cdots \\
1&{{x_n}}&{x_n^2}& \cdots &{x_n^n}
\end{array}} \right| = \prod\limits_{i = 1}^n {\prod\limits_{j = 0}^{i - 1} {({x_i} - {x_j})} }
$$
由于 ${x_i} - {x_j} \ne 0$ 于是 ${V_n}({x_0},{x_1}, \cdots ,{x_n}) \ne 0$ ，所以方程组存在唯一的一组解。

> 定理：满足 $P({x_i}) = {y_i}\,,\;\;i = 0,\;...\;,\;n$ 次数不超过 $n$ 的插值多项式是唯一存在的。

优点:简单粗暴

缺点:要解 $n+1$ 个方程，时间复杂度较高，$n$ 不好确定，若 $n$ 过大，容易过拟合，若 $n$ 过小，容易欠拟合

## 3 拉格朗日插值

### 3.1 拉格朗日插值多项式

* **线性插值**

  过曲线 $y=f(x)$ 上两点 $M_0(x_0,y_0), M_1(x_1,y_1)$ 由两点式得：
  $$
  {L_1}(x) = {y_0}\frac{{x - {x_1}}}{{{x_0} - {x_1}}} + {y_1}\frac{{x - {x_0}}}{{{x_1} - {x_0}}}
  $$
  显然 $L1(x)$ 为插值多项式

* **抛物线插值**
  过曲线 $y=f(x)$ 上三点$M_0(x_0,y_0), M_1(x_1,y_1), M_2(x_2, y_2)$ 做抛物线 $L_2(x)$ , 同样不难得到：
  $$
  {L_2}(x) = {y_0}\frac{{(x - {x_1})(x - {x_2})}}{{({x_0} - {x_1})({x_0} - {x_2})}} + {y_1}\frac{{(x - {x_0})(x - {x_2})}}{{({x_1} - {x_0})({x_1} - {x_2})}} + {y_2}\frac{{(x - {x_0})(x - {x_1})}}{{({x_2} - {x_0})({x_2} - {x_1})}}
  $$
  显然 $L_2(x)$ 也为插值多项式


用类似的推导方式可以证明，$n+1$ 个节点的拉格朗日插值多项式应定义为如下形式。

**定义**：$y=f(x)$ 在插值节点 $x_0,x_1,...,x_n$ 上的**拉格朗日插值多项式**为：
$$
{L_n}(x) = {y_0}{l_0}(x) + {y_1}{l_1}(x) +  \cdots  + {y_n}{l_n}(x) = \sum\limits_{i = 0}^n {{y_i}{l_i}(x)} 
$$
其中 $l_i(x)$ 为**插值基函数**：
$$
{l_i}(x) = \frac{{(x - {x_0}) \cdots (x - {x_{i - 1}})(x - {x_{i + 1}}) \cdots (x - {x_n})}}{{({x_i} - {x_0}) \cdots ({x_i} - {x_{i - 1}})({x_i} - {x_{i + 1}}) \cdots ({x_i} - {x_n})}}
$$
为了方便表示，引入记号：
$$
{\omega _{n + 1}}(x) = (x - {x_0})(x - {x_{1}})...(x - {x_n})
$$
且有：
$$
\omega _{_{n + 1}}^ {'} ({x_i}) = ({x_i} - {x_0})({x_i} - {x_{1}})...({x_i} - {x_n})
$$
因此最终，拉格朗日多项式可以写为：
$$
{L_n}(x) = \sum\limits_{i = 0}^n {\frac{{{\omega _{n + 1}}(x)}}{{(x - {x_i})\omega _{n + 1}^{'}({x_i})}}}
$$

### 3.2 插值余项和误差估计

在 $[a,b]$ 上用 $L_n (x)$ 近似 $f(x)$，则其截断误差 $R_n ( x ) = f ( x ) − L_n ( x )$ ，也称为**插值多项式的余项**，若 $f(x)$ 的 $n$ 阶导数连续，$n+1$ 阶导数存在，则:
$$
{R_n}(x) = f(x) - {L_n}(x) = \frac{{{f^{(n + 1)}}({\xi _x})}}{{(n + 1)\;!}}\prod\limits_{i = 0}^n {(x - {x_i})} 
$$
其中 $\xi \in (a,b) $且依赖于 $x$ 。通常不能确定 $\xi_x$  , 而是估计 $\left| {{f^{(n + 1)}}(x)} \right| \le {M_{n + 1}}$ 将作为误差估计上限。

### 3.5 计算步骤

1. 输入 $x_i,y_i,(i=0,1,...,n)$ 
2. 对 $i=0,1,...,n$ 计算插值基函数 $l_i(x)$ 
3. 计算插值多项式 ${L_{\rm{n}}}{\rm{(x) = }}\sum\limits_{i = 0}^n {{y_i}{l_i}} $ 
4. 输出 $L\approx f(x)$ ，结束

### 3.4 优缺点

Lagrange插值多项式的缺点：

- 插值基函数计算复杂
- **当增加一个新点时需重新计算**
- **插值多项式从 $n$ 次增加到 $n+1$ 次需重新计算**
- 插值曲线在节点处有尖点，不光滑，节点处不可导
- 高次插值的精度不一定高



例题：已知 $\sin \frac{\pi }{6} = \frac{1}{2}\;,\;\;\sin \frac{\pi }{4} = \frac{1}{{\sqrt 2 }}\;,\;\;\sin \frac{\pi }{3} = \frac{{\sqrt 3 }}{2}$ ，分别利用1次，2次拉格朗日插值计算 $sin 50^°$ 并估计误差。

$n=1$ 利用 ${x_0} = \frac{\pi }{6}\;,\;{x_1} = \frac{\pi }{4}$ :  $sin 50^°$ = 0.77614… 二次插值的实际误差 $\approx $ 0.01010

$n=2$ :  $sin 50^°$ = 0.76543… 二次插值的实际误差 $\approx $ 0.00061

## 4 牛顿插值

### 4.1 差商

> **定义1**. 设 $f(x)$ 在互异节点 $x_i$ 处的函数值为 $f_i,i = 0,1,...,n$ 称： 

$$
f[{x_i}\;,\;{x_j}] = \frac{{f({x_i}) - f({x_j})}}{{{x_i} - {x_j}}}\quad (i \ne j,\;\;{x_i} \ne {x_j})
$$
为 $f(x)$ 关于节点 $x_i,x_j$ 的**一阶差商**。称：
$$
f[{x_i}\;,\;{x_j}\;,\;{x_k}] = \frac{{f[{x_i}\;,\;{x_j}] - f[{x_j}\;,\;{x_k}]}}{{{x_i}\; - \;{x_k}}}\quad (i \ne k)
$$
为 $f(x)$ 关于节点 $x_i,x_j,x_k$ 的**二阶差商**。称：
$$
f[{x_0}\;,\;{x_1}\;,...,\;{x_{k + 1}}] = \frac{{f[{x_0}\;,\;{x_1},...,{x_k}] - f[{x_1}\;,\;...,{x_k},{x_{k + 1}}]}}{{{x_0}\; - \;{x_{k + 1}}}}
$$
为$f(x)$ 关于节点 $x_0,x_1,...,x_{k + 1}$ 的**k阶差商**。

![image-20201116162613851](https://gitee.com/jchenTech/images/raw/master/img/20201116162613.png)

### 4.2 差商的性质

* 线性性

  $k$ 阶差商可表示为函数值 $f({x_0}),f({x_1}), \cdots ,f({x_k})$ 的线性组合
  $$
  f[{x_0}, \cdots ,{x_k}] = \sum\limits_{j = 0}^k {\frac{{f({x_j})}}{{({x_j} - {x_0}) \cdots ({x_j} - {x_{j - 1}})({x_j} - {x_{j + 1}}) \cdots ({x_j} - {x_k})}}}  = \sum\limits_{j = 0}^k {\frac{{f({x_j})}}{{{{\omega '}_{k + 1}}({x_j})}}}
  $$
  其中：
  $$
  {\omega _{k + 1}} = \prod\limits_{i = 0}^k {(x - {x_i})}
  $$

* 对称性
  $$
  f[{x_0},{x_1}, \cdots ,{x_k}] = f[{x_1},{x_0},{x_2} \cdots ,{x_k}] =  \cdots  = f[{x_1}, \cdots ,{x_k},{x_0}]
  $$
  
* 差商 和导数的关系

  当 $f( x )$ 在区间 $[a,b]$ 存在 $n$ 阶导数，且 $x_0,x_1,...,x_k \in [a,b]$ ，则 $n$ 阶差商与 $n$ 阶导数之间的关系为：
  $$
  f[{x_0},{x_1} \cdots ,{x_n}] = \frac{{{f^{(n)}}(\xi )}}{{n!}}
  $$

  ### 4.3 牛顿插值

>  **定义2**：称多项式：
> $$
\begin{array}{*{20}{l}}
{{N_n}(x) = f({x_0}) + f[{x_0},{x_1}](x - {x_0}) + f[{x_0},{x_1},{x_2}](x - {x_0})(x - {x_1}) +  \cdots  + f[{x_0},{x_{1,}} \cdots ,{x_n}](x - {x_0})(x - {x_1}) \cdots (x - {x_{n - 1}})}\\
{ = f_0 + \sum\limits_{j = 0}^{k - 1} {f[{x_0},{x_{1,}} \cdots ,{x_k}]} {\omega _k}(x)}
\end{array}
> $$
> 为**牛顿插值多项式** ，其中 ${\omega _k}(x) = \prod\limits_{j = 0}^{k - 1} {{\rm{(}}x - {x_{\rm{j}}}{\rm{)}}} $。称：
>$$
{R_n}(x) = f(x) - N_n(x)=f[x,{x_0},\;...\;,{x_n}]{\omega _{n + 1}}(x)
> $$
> 称为**牛顿插值多项式的余项**。

例题： 给出 $f(x)$ 的函数表，求三次牛顿插值多项式，再求四次。

| $x_i$ | $f(x_i)$ | 一阶均差 | 二阶均差 | 三阶均差 | 四阶均差 |
| ----- | -------- | -------- | -------- | -------- | -------- |
| 0.40  | 0.41075  |          |          |          |          |
| 0.55  | 0.57815  | 1.11600  |          |          |          |
| 0.65  | 0.69675  | 1.18600  | 0.28000  |          |          |
| 0.80  | 0.88811  | 1.27573  | 0.35893  | 0.19733  |          |
| 0.90  | 1.02652  | 1.38410  | 0.43348  | 0.21300  | 0.03134  |

### 4.4 计算步骤

1. 输入 $x_i,y_i,(i=0,1,...,n)$ 
2. 对 $i=0,1,...,n$ 计算一阶差商
3. 对 $i=0,1,...,n$ 计算二阶差商
4. ......
5. 计算插值多项式 $ p = f_0 + \sum\limits_{j = 0}^{k - 1} {f[{x_0},{x_{1,}} \cdots ,{x_k}]} {\omega _k}(x)$
6. 输出 $p\approx f(x)$ ，结束

### 4.5 优缺点

- 优点：计算简单
- 缺点：和拉格朗日插值方法相同，插值曲线在节点处有尖点，不光滑，节点处不可导

## 5 Hermite插值

### 5.1 Hermite插值多项式

>  **定义**：设 $f(x)$ 在节点 $a \le x_0,x_1,...,x_n \le b$ 处的函数值为 $y_0,y_1,...,y_n$ 设 $P(x)$ 为 $f(x)$ 在区间 $[a,b]$ 上具有一阶导数的插值函数。

（1） 若要求 $P(x)$ 在区间 $[a,b]$上具有一阶导数(一阶光滑度)，显然 $P(x)$ 在节点 $x_0,x_1,...,x_n$ 处必须满足：
$$
\begin{aligned} P\left(x_{i}\right) &=f\left(x_{i}\right)=y_{i}, i=0,1, \ldots, n \\ P^{\prime}\left(x_{i}\right) &=f^{\prime}\left(x_{i}\right)=y_{i}^{\prime}, i=0,1, \ldots, n \end{aligned}
$$

共 $2n+2$个方程解出 $2n+2$ 个待定的系数，因此P(x)可以是最高次数为 $2n+1$ 次的多项式，两个节点就是三次多项式作为插值函数。

（2）若要求 $P(x)$ 在区间 $[a,b]$上具有m阶导数(一阶光滑度)，显然 $P(x)$ 在节点 $x_0,x_1,...,x_n$ 处必须满足：
$$
\begin{array}{c}
P\left(x_{i}\right)=f\left(x_{i}\right)=y_{i} \\
P^{\prime}\left(x_{i}\right)=f^{\prime}\left(x_{i}\right)=y_{i}^{\prime} \\
P^{\prime \prime}\left(x_{i}\right)=f^{\prime \prime}\left(x_{i}\right)=y_{i}^{\prime \prime}, i=0,1, \ldots n \\
\ldots P^{m}\left(x_{i}\right)=f^{m}\left(x_{i}\right)=y_{i}^{m}
\end{array}
$$
称满足(1)(2)的插值多项式为**埃尔米特插值多项式**，记为 $H_k(x)$，$k$ 为多项式次数。($k$过大会影响收敛性和稳定性)



因此我们可以定义**Hermite插值多项式**:
$$
H_{2 n+1}(x)=\sum_{j=0}^{n}\left[y_{j} \alpha_{j}(x)+y_{j}^{\prime} \beta_{j}(x)\right]
$$
其中：
$$
\begin{array}{c}\alpha_{j}(x)=\left[1-2\left(x-x_{j}\right) \sum_{k=0, k \neq j}^{n} \frac{1}{x_{j}-x_{k}}\right] l_{j}^{2}(x) \\\beta_{j}(x)=\left(x-x_{j}\right) l_{j}^{2}(x)\end{array}
$$
余项:
$$
R_{2n+1}(x)=f(x)-H_{2n+1}(x)=\frac{f^{(2n+2)}\left(\xi_{x}\right)}{(2n+2) !} \omega_{n+1}^{2}(x)
$$
其中：
$$
\omega_{n+1}(x)=\prod_{i=0}^{n}\left(x-x_{i}\right), \xi \in[a, b]
$$

### 5.2 重节点差商

设  $f \in C^{n}[a, b], x_{0}, x_{1}, \ldots, x_{n}$  为 $[a,b]$ 上的相异节点, 则 $ f\left[x_{0}, x_{1}, \ldots, x_{n}\right] $ 是其变量的连续函数, 根据差商定义, 若  $f \in C^{1}[a, b]$， 则有:

### 5.3 两点三次Hermite插值

| $x$        | $x_0$     | $x_1$     |
| ---------- | --------- | --------- |
| $f(x)$     | $y_0$     | $y_1$     |
| $f^{'}(x)$ | $y^{'}_0$ | $y_1^{'}$ |

三次Hermite插值多项式为：
$$
\begin{array}{l}
{H_3}(x) = {y_0}\left( {1 + 2\frac{{x - {x_0}}}{{{x_1} - {x_0}}}} \right){\left( {\frac{{x - {x_1}}}{{{x_0} - {x_1}}}} \right)^2}\\
 + {y_1}\left( {1 + 2\frac{{x - {x_1}}}{{{x_0} - {x_1}}}} \right){\left( {\frac{{x - {x_0}}}{{{x_1} - {x_0}}}} \right)^2}\\
 + y_0^\prime \left( {x - {x_0}} \right){\left( {\frac{{x - {x_1}}}{{{x_0} - {x_1}}}} \right)^2}\\
 + y_1^\prime \left( {x - {x_1}} \right){\left( {\frac{{x - {x_0}}}{{{x_1} - {x_0}}}} \right)^2}
\end{array}
$$
余项：
$$
R_{3}(x)=\frac{f^{(4)}(\xi)}{4 !}\left(x-x_{0}\right)^{2}\left(x-x_{1}\right)^{2}, \xi \in[a, b]
$$

### 5.4 三点三次带一个导数插值



## 6 分段低次插值

### 6.1 高次插值的龙格现象

龙格现象就是插值多项式不收敛现象，节点(插值多项式的次数)增加不会带来精度的改善，甚至可能增加误差。

### 6.2 分段低次插值

对给定区间 $[a, b]$ 做分割： $a=x_{0}<x_{1}<\ldots<x_{n}=b,$ 在每个小区间 $\left[x_{i}, x_{i+1}\right]$ 上 以 $x_{i}, x_{i+1}$ 为节点作 $f(x)$ 的线性插值：
$$
S_{i}(x)=\frac{x-x_{i+1}}{x_{i}-x_{i+1}} f\left(x_{i}\right)+\frac{x-x_{i}}{x_{i+1}-x_{i}} f\left(x_{i+1}\right), x \in\left[x_{i}, x_{i+1}\right]
$$
把每个小区间上的线性插值函数连起来，就得到了分段线性插值函数 $S(x)$ ，误差公式为：
$$
|f(x)-S(x)| \leq \frac{M_{2}}{8}\left(x_{i}-x_{i+1}\right)^{2}, M_{2}=\max _{a \leq x \leq b}\left|f^{\prime \prime}(x)\right|
$$

### 6.3 分段三次Hermite插值

对给定区间 $[a, b]$ 做分割： $a=x_{0}<x_{1}<\ldots<x_{n}=b,$ 在每个小区间 $\left[x_{i}, x_{i+1}\right]$ 上 以 $x_{i}, x_{i+1}$ 为节点作分段三次Hermite插值:
$$
S_{i}(x)=f\left(x_{i}\right)\left(1-2 \frac{x-x_{i}}{x_{i}-x_{i+1}}\right)\left(\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\right)^{2}\\
+f\left(x_{i+1}\right)\left(1-2 \frac{x-x_{i+1}}{x_{i}-x_{i+1}}\right)\left(\frac{x-x_{i}}{x_{i+1}-x_{i}}\right)^{2} \\
+f^{\prime}\left(x_{i}\right)\left(x-x_{i}\right)\left(\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\right)^{2}\\
+f^{\prime}\left(x_{i+1}\right)\left(x-x_{i+1}\right)\left(\frac{x-x_{i}}{x_{i+1}-x_{i}}\right)^{2}
$$
误差公式为：
$$
|f(x)-S(x)| \leq \frac{h^{4}}{384} \max _{x_{i} \leq x \leq x_{i-1}}\left|f^{(4)}(x)\right|, h=\max _{0 \leq i \leq n-1}\left|x_{i+1}-x_{i}\right|
$$
