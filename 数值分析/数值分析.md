# 第一章 误差

## 1 误差及相关概念

本章需要的掌握的误差概念

* 截断误差：是指计算某个算式时没有精确的计算结果，如积分计算，无穷级数计算等，使用极限的形式表达的，显然我们只能截取有限项进行计算，此时必定会有误差存在，这就是截断误差。
* 舍入误差：是指由于计算机表示位数的有限，很难表示位数很长的数字，这时计算机就会将其舍成一定的位数，引起舍入误差，每一步的舍入误差是微不足道的，但经过传播和积累，舍入误差可能会淹没所要的真解。
* 绝对误差：是指近似值与真实值之间的误差，它们之间的误差上限称为绝对误差限或者精度。
* 相对误差：有时绝对误差还不足刻画近似值的精度，为此引入相对误差，即绝对误差与近似值的比值。
* 有效数字



## 2 绝对误差和相对误差

### 2.1 绝对误差和相对误差限

设数 $x$ 为精确数（精确值或真值），数$x^*$为其近似数（近似值），则近似值$x^*$的**绝对误差**为：
$$
e(x)=x^*-x
$$
一般情况下，人们无法准确地知道精确值 $x$ 的大小，但是如果我们知道绝对误差的范围：
$$
|e(x)| = |{x^*} - x| \le \varepsilon
$$
则称 $ \varepsilon$ 为近似值 $x$ 的**绝对误差限**， 如果估计出 $\varepsilon$ ，则可以确定 $x$ 的数值范围：
$$
x - \varepsilon  \le x^*  \le x + \varepsilon
$$
绝对误差不足以刻画近似数的精确程度，除了绝对误差以外，还必须考虑此数本身的大小，即有相对误差的概念。

### 2.2 相对误差和相对误差限

定义近似数x的**相对误差**为绝对误差与准确值 $x$ 之间的比值，但是由于准确值一般都是未知的，所以近似以估计值 $x^*$ 取代：
$$
{e_r}(x) = \frac{e}{x} = \frac{{({x^*} - x)}}{x} \approx \frac{{({x^*} - x)}}{{{x^*}}}
$$
相应地，相对误差限 $\epsilon_r$ 定义为：
$$
|{e_r}(x)| = |\frac{{({x^*} - x)}}{x}| \le \varepsilon
$$

$$
\varepsilon_r=\frac{\varepsilon}{|x^*|}
$$



## 3 有效数字

设 $x$ 的近似值是 $x^* =  \pm 0.{a_1}{a_2} \cdots {a_n} \times {10^m},{a_1} \ne 0$ ，如果当：
$$
|e| = |{x^*} - x| \le \frac{1}{2} \times {10^{m - n}}
$$
那么称近似值 $x$ 具有n位**有效数字**或称 $x$ 精确到 $10^{m-n}$ 。

例题：近似值a=1.38，近似值的绝对误差限为 $0.5 \times 10^{-2}$ ，那么近似值的有效数字有几位？(3)

   

## 4 有效数字与相对误差的关系

**有效数字=》相对误差限**

已知 $x^*$ 有 $n$ 位有效数字，则其相对误差限为
$$
{\varepsilon _r}* = \left| {\frac{{\varepsilon *}}{{x*}}} \right| = \frac{{0.5 \times {{10}^{m - n}}}}{{0.{a_1}{a_2} \cdots {a_n} \times {{10}^m}}} = \frac{{{{10}^{ - n}}}}{{2 \times 0.{a_1} \cdots }} \le \frac{1}{{2{a_1}}} \times {10^{ - n + 1}}
$$


**相对误差限=》有效数字**

已知 $x^*$ 的相对误差限可写为：${\varepsilon _r}^* = \frac{1}{{2({a_1} + 1)}} \times {10^{ - n + 1}}$ 则：
$$
\begin{array}{l}
|x - x^*|\; \le \;{\varepsilon _r}^* \cdot |x^*| = \frac{{{{10}^{ - n + 1}}}}{{2({a_1} + 1)}} \times 0.{a_1}{a_2} \cdots  \times {10^m}\\
 < \frac{{{{10}^{ - n + 1}}}}{{2({a_1} + 1)}} \cdot ({a_1} + 1) \times {10^{m - 1}} = 0.5 \times {10^{m - n}}
\end{array}
$$
 可见 $x^*$ 至少有 $n$ 位有效数字。

例：为使 ${\pi ^*}$的相对误差小于0.001%,至少应取几位有效数字？(6)

解：假设 ${\pi ^*}$ 取到 $n$ 位有效数字，则其相对误差上限为：
$$
{\varepsilon _r}^* = \frac{1}{{2({a_1} + 1)}} \times {10^{ - n + 1}}
$$
要保证其相对误差小于0.001%，只要保证其上限满足：
$$
{\varepsilon _r}^* = \frac{1}{{2({a_1} + 1)}} \times {10^{ - n + 1}} <0.001\%
$$
已知 $a_1 = 3$，则从以上不等式可解得 $n > 6-log6$，即 $n \ge 6$，应取 $\pi^* = 3.14159$。



# 第二章 插值

## 1 插值

> **定义**：设函数 $y=f(x)$ 在区间[a, b]上的 $n + 1$ 个点， $a \le x_0,x_1,...,x_n \le b$ 上的函数值为 $y_0,y_1,...,y_n$ 若存在函数 $P(x)$ ， 使得：
> $$
> P(x_i)=y_i,i=0,1,...,n
> $$
> 成立，则称函数 $P(x)$ 为 $f(x)$的**插值函数**，$f(x)$ 称为被插值函数，点 $x_0,x_1,...,x_n$ 称为插值节点，包含插值节点的区间[a, b] 称为插值区间。

一般来说 $P(x)$ 分为三类，一类是 $n$ 次多项式 $a_0 + a_1 x + ... + a_n x_n$，一类是三角多项式，最后一类是分段 $n$ 次多项式。

## 2 多项式插值

- 插值多项式是否存在，若存在是否唯一
- 怎么推导插值多项式
- 如何应用

这个可以说是最简单的插值了。由插值条件可得：
$$
\left\{ \begin{array}{l}
{a_0} + {a_1}{x_0} + a{}_2x_0^2 +  \cdots  + {a_n}x_0^n = {y_0}\\
{a_0} + {a_1}{x_1} + a{}_2x_1^2 +  \cdots  + {a_n}x_1^n = {y_1}\\
 \vdots \\
{a_0} + {a_1}{x_n} + {a_2}x_n^2 +  \cdots  + {a_n}x_n^n = {y_n}
\end{array} \right.
$$
这是一个关于 ${a_0},{a_1} \cdots {a_n}$ 的 $n+1$ 元线性方程组。

证明插值多项式的存在唯一性：上述线性方程组的系数行列式为Vandermond行列式，计算过程为：
$$
{V_n}({x_0},{x_1}, \cdots ,{x_n}) = \left| {\begin{array}{*{20}{c}}
1&{{x_0}}&{x_0^2}& \cdots &{x_0^n}\\
1&{{x_1}}&{x_1^2}& \cdots &{x_1^n}\\
 \cdots & \cdots & \cdots & \cdots & \cdots \\
1&{{x_n}}&{x_n^2}& \cdots &{x_n^n}
\end{array}} \right| = \prod\limits_{i = 1}^n {\prod\limits_{j = 0}^{i - 1} {({x_i} - {x_j})} }
$$
由于 ${x_i} - {x_j} \ne 0$ 于是 ${V_n}({x_0},{x_1}, \cdots ,{x_n}) \ne 0$ ，所以方程组存在唯一的一组解。

**定理：满足 $P({x_i}) = {y_i}\,,\;\;i = 0,\;...\;,\;n$ 次数不超过 $n$ 的插值多项式是唯一存在的。



优点:简单粗暴

缺点:要解 $n+1$ 个方程，时间复杂度较高，$n$ 不好确定，若 $n$ 过大，容易过拟合，若 $n$ 过小，容易欠拟合

## 3 拉格朗日插值

### 3.1 拉格朗日插值多项式

* **线性插值**

  过曲线 $y=f(x)$ 上两点 $M_0(x_0,y_0), M_1(x_1,y_1)$ 由两点式得：
  $$
  {L_1}(x) = {y_0}\frac{{x - {x_1}}}{{{x_0} - {x_1}}} + {y_1}\frac{{x - {x_0}}}{{{x_1} - {x_0}}}
  $$
  显然 $L1(x)$ 为插值多项式

* **抛物线插值**
  过曲线 $y=f(x)$ 上三点$M_0(x_0,y_0), M_1(x_1,y_1), M_2(x_2, y_2)$ 做抛物线 $L_2(x)$ , 同样不难得到：
  $$
  {L_2}(x) = {y_0}\frac{{(x - {x_1})(x - {x_2})}}{{({x_0} - {x_1})({x_0} - {x_2})}} + {y_1}\frac{{(x - {x_0})(x - {x_2})}}{{({x_1} - {x_0})({x_1} - {x_2})}} + {y_2}\frac{{(x - {x_0})(x - {x_1})}}{{({x_2} - {x_0})({x_2} - {x_1})}}
  $$
  显然 $L_2(x)$ 也为插值多项式

* 



用类似的推导方式可以证明，$n+1$ 个节点的拉格朗日插值多项式应定义为如下形式。

**定义**：$y=f(x)$ 在插值节点 $x_0,x_1,...,x_n$ 上的**拉格朗日插值多项式**为：
$$
{L_n}(x) = {y_0}{l_0}(x) + {y_1}{l_1}(x) +  \cdots  + {y_n}{l_n}(x) = \sum\limits_{i = 0}^n {{y_i}{l_i}(x)} 
$$
其中 $l_i(x)$ 为**插值基函数**：
$$
{l_i}(x) = \frac{{(x - {x_0}) \cdots (x - {x_{i - 1}})(x - {x_{i + 1}}) \cdots (x - {x_n})}}{{({x_i} - {x_0}) \cdots ({x_i} - {x_{i - 1}})({x_i} - {x_{i + 1}}) \cdots ({x_i} - {x_n})}}
$$
为了方便表示，引入记号：
$$
{\omega _{n + 1}}(x) = (x - {x_0})(x - {x_{1}})...(x - {x_n})
$$
且有：
$$
\omega _{_{n + 1}}^ {'} ({x_i}) = ({x_i} - {x_0})({x_i} - {x_{1}})...({x_i} - {x_n})
$$
因此最终，拉格朗日多项式可以写为：
$$
{L_n}(x) = \sum\limits_{i = 0}^n {\frac{{{\omega _{n + 1}}(x)}}{{(x - {x_i})\omega _{n + 1}^{'}({x_i})}}}
$$

### 3.2 插值余项和误差估计

在 $[a,b]$ 上用 $L_n (x)$ 近似 $f(x)$，则其截断误差 $R_n ( x ) = f ( x ) − L_n ( x )$ ，也称为**插值多项式的余项**，若 $f(x)$ 的 $n$ 阶导数连续，$n+1$ 阶导数存在，则:
$$
{R_n}(x) = f(x) - {L_n}(x) = \frac{{{f^{(n + 1)}}({\xi _x})}}{{(n + 1)\;!}}\prod\limits_{i = 0}^n {(x - {x_i})} 
$$
其中 $\xi \in (a,b) $且依赖于 $x$ 。通常不能确定 $\xi_x$  , 而是估计 $\left| {{f^{(n + 1)}}(x)} \right| \le {M_{n + 1}}$ 将作为误差估计上限。

### 3.5 计算步骤

1. 输入 $x_i,y_i,(i=0,1,...,n)$ 
2. 对 $i=0,1,...,n$ 计算插值基函数 $l_i(x)$ 
3. 计算插值多项式 ${L_{\rm{n}}}{\rm{(x) = }}\sum\limits_{i = 0}^n {{y_i}{l_i}} $ 
4. 输出 $L\approx f(x)$ ，结束

### 3.4 优缺点

Lagrange插值多项式的缺点：

- 插值基函数计算复杂
- **当增加一个新点时需重新计算**
- **插值多项式从 $n$ 次增加到 $n+1$ 次需重新计算**
- 插值曲线在节点处有尖点，不光滑，节点处不可导
- 高次插值的精度不一定高



例题：已知 $\sin \frac{\pi }{6} = \frac{1}{2}\;,\;\;\sin \frac{\pi }{4} = \frac{1}{{\sqrt 2 }}\;,\;\;\sin \frac{\pi }{3} = \frac{{\sqrt 3 }}{2}$ ，分别利用1次，2次拉格朗日插值计算 $sin 50^°$ 并估计误差。

$n=1$ 利用 ${x_0} = \frac{\pi }{6}\;,\;{x_1} = \frac{\pi }{4}$ :  $sin 50^°$ = 0.77614… 二次插值的实际误差 $\approx $ 0.01010

$n=2$ :  $sin 50^°$ = 0.76543… 二次插值的实际误差 $\approx $ 0.00061

## 4 牛顿插值

### 4.1 差商

> **定义1**. 设 $f(x)$ 在互异节点 $x_i$ 处的函数值为 $f_i,i = 0,1,...,n$ 称： 

$$
f[{x_i}\;,\;{x_j}] = \frac{{f({x_i}) - f({x_j})}}{{{x_i} - {x_j}}}\quad (i \ne j,\;\;{x_i} \ne {x_j})
$$

为 $f(x)$ 关于节点 $x_i,x_j$ 的**一阶差商**。称：
$$
f[{x_i}\;,\;{x_j}\;,\;{x_k}] = \frac{{f[{x_i}\;,\;{x_j}] - f[{x_j}\;,\;{x_k}]}}{{{x_i}\; - \;{x_k}}}\quad (i \ne k)
$$
为 $f(x)$ 关于节点 $x_i,x_j,x_k$ 的**二阶差商**。称：
$$
f[{x_0}\;,\;{x_1}\;,...,\;{x_{k + 1}}] = \frac{{f[{x_0}\;,\;{x_1},...,{x_k}] - f[{x_1}\;,\;...,{x_k},{x_{k + 1}}]}}{{{x_0}\; - \;{x_{k + 1}}}}
$$
为$f(x)$ 关于节点 $x_0,x_1,...,x_{k + 1}$ 的**k阶差商**。

![image-20201116162613851](https://gitee.com/jchenTech/images/raw/master/img/20201121145015.png)

### 4.2 差商的性质

* 线性性

  $k$ 阶差商可表示为函数值 $f({x_0}),f({x_1}), \cdots ,f({x_k})$ 的线性组合
  $$
  f[{x_0}, \cdots ,{x_k}] = \sum\limits_{j = 0}^k {\frac{{f({x_j})}}{{({x_j} - {x_0}) \cdots ({x_j} - {x_{j - 1}})({x_j} - {x_{j + 1}}) \cdots ({x_j} - {x_k})}}}  = \sum\limits_{j = 0}^k {\frac{{f({x_j})}}{{{{\omega '}_{k + 1}}({x_j})}}}
  $$
  其中：
  $$
  {\omega _{k + 1}} = \prod\limits_{i = 0}^k {(x - {x_i})}
  $$

* 对称性
  $$
  f[{x_0},{x_1}, \cdots ,{x_k}] = f[{x_1},{x_0},{x_2} \cdots ,{x_k}] =  \cdots  = f[{x_1}, \cdots ,{x_k},{x_0}]
  $$

* 差商和导数的关系

  当 $f( x )$ 在区间 $[a,b]$ 存在 $n$ 阶导数，且 $x_0,x_1,...,x_k \in [a,b]$ ，则 $n$ 阶差商与 $n$ 阶导数之间的关系为：
  $$
  f[{x_0},{x_1} \cdots ,{x_n}] = \frac{{{f^{(n)}}(\xi )}}{{n!}}
  $$

  ### 4.3 牛顿插值

>  **定义2**：称多项式：
>  $$
>  \begin{array}{*{20}{l}}
>  {{N_n}(x) = f({x_0}) + f[{x_0},{x_1}](x - {x_0}) + f[{x_0},{x_1},{x_2}](x - {x_0})(x - {x_1}) +  \cdots  + f[{x_0},{x_{1,}} \cdots ,{x_n}](x - {x_0})(x - {x_1}) \cdots (x - {x_{n - 1}})}\\
>  { = f_0 + \sum\limits_{j = 0}^{k - 1} {f[{x_0},{x_{1,}} \cdots ,{x_k}]} {\omega _k}(x)}
>  \end{array}
>  $$
>  为**牛顿插值多项式** ，其中 ${\omega _k}(x) = \prod\limits_{j = 0}^{k - 1} {{\rm{(}}x - {x_{\rm{j}}}{\rm{)}}} $。称：
>  $$
>  {R_n}(x) = f(x) - N_n(x)=f[x,{x_0},\;...\;,{x_n}]{\omega _{n + 1}}(x)
>  $$
>  称为**牛顿插值多项式的余项**。

例题： 给出 $f(x)$ 的函数表，求三次牛顿插值多项式，再求四次。

| $x_i$ | $f(x_i)$ | 一阶均差 | 二阶均差 | 三阶均差 | 四阶均差 |
| ----- | -------- | -------- | -------- | -------- | -------- |
| 0.40  | 0.41075  |          |          |          |          |
| 0.55  | 0.57815  | 1.11600  |          |          |          |
| 0.65  | 0.69675  | 1.18600  | 0.28000  |          |          |
| 0.80  | 0.88811  | 1.27573  | 0.35893  | 0.19733  |          |
| 0.90  | 1.02652  | 1.38410  | 0.43348  | 0.21300  | 0.03134  |

### 4.4 计算步骤

1. 输入 $x_i,y_i,(i=0,1,...,n)$ 
2. 对 $i=0,1,...,n$ 计算一阶差商
3. 对 $i=0,1,...,n$ 计算二阶差商
4. ......
5. 计算插值多项式 $ p = f_0 + \sum\limits_{j = 0}^{k - 1} {f[{x_0},{x_{1,}} \cdots ,{x_k}]} {\omega _k}(x)$
6. 输出 $p\approx f(x)$ ，结束

### 4.5 优缺点

- 优点：计算简单
- 缺点：和拉格朗日插值方法相同，插值曲线在节点处有尖点，不光滑，节点处不可导

## 5 Hermite插值

### 5.1 Hermite插值多项式

>  **定义**：设 $f(x)$ 在节点 $a \le x_0,x_1,...,x_n \le b$ 处的函数值为 $y_0,y_1,...,y_n$ 设 $P(x)$ 为 $f(x)$ 在区间 $[a,b]$ 上具有一阶导数的插值函数。

（1） 若要求 $P(x)$ 在区间 $[a,b]$上具有一阶导数(一阶光滑度)，显然 $P(x)$ 在节点 $x_0,x_1,...,x_n$ 处必须满足：
$$
\begin{aligned} P\left(x_{i}\right) &=f\left(x_{i}\right)=y_{i}, i=0,1, \ldots, n \\ P^{\prime}\left(x_{i}\right) &=f^{\prime}\left(x_{i}\right)=y_{i}^{\prime}, i=0,1, \ldots, n \end{aligned}
$$

共 $2n+2$个方程解出 $2n+2$ 个待定的系数，因此P(x)可以是最高次数为 $2n+1$ 次的多项式，两个节点就是三次多项式作为插值函数。

（2）若要求 $P(x)$ 在区间 $[a,b]$上具有m阶导数(一阶光滑度)，显然 $P(x)$ 在节点 $x_0,x_1,...,x_n$ 处必须满足：
$$
\begin{array}{c}
P\left(x_{i}\right)=f\left(x_{i}\right)=y_{i} \\
P^{\prime}\left(x_{i}\right)=f^{\prime}\left(x_{i}\right)=y_{i}^{\prime} \\
P^{\prime \prime}\left(x_{i}\right)=f^{\prime \prime}\left(x_{i}\right)=y_{i}^{\prime \prime}, i=0,1, \ldots n \\
\ldots P^{m}\left(x_{i}\right)=f^{m}\left(x_{i}\right)=y_{i}^{m}
\end{array}
$$
称满足(1)(2)的插值多项式为**埃尔米特插值多项式**，记为 $H_k(x)$，$k$ 为多项式次数。($k$过大会影响收敛性和稳定性)



因此我们可以定义**Hermite插值多项式**:
$$
H_{2 n+1}(x)=\sum_{j=0}^{n}\left[y_{j} \alpha_{j}(x)+y_{j}^{\prime} \beta_{j}(x)\right]
$$
其中：
$$
\begin{array}{c}\alpha_{j}(x)=\left[1-2\left(x-x_{j}\right) \sum_{k=0, k \neq j}^{n} \frac{1}{x_{j}-x_{k}}\right] l_{j}^{2}(x) \\\beta_{j}(x)=\left(x-x_{j}\right) l_{j}^{2}(x)\end{array}
$$
余项:
$$
R_{2n+1}(x)=f(x)-H_{2n+1}(x)=\frac{f^{(2n+2)}\left(\xi_{x}\right)}{(2n+2) !} \omega_{n+1}^{2}(x)
$$
其中：
$$
\omega_{n+1}(x)=\prod_{i=0}^{n}\left(x-x_{i}\right), \xi \in[a, b]
$$

### 5.2 重节点差商

设  $f \in C^{n}[a, b], x_{0}, x_{1}, \ldots, x_{n}$  为 $[a,b]$ 上的相异节点, 则 $ f\left[x_{0}, x_{1}, \ldots, x_{n}\right] $ 是其变量的连续函数, 根据差商定义, 若  $f \in C^{1}[a, b]$， 则有:

### 5.3 两点三次Hermite插值

| $x$        | $x_0$     | $x_1$     |
| ---------- | --------- | --------- |
| $f(x)$     | $y_0$     | $y_1$     |
| $f^{'}(x)$ | $y^{'}_0$ | $y_1^{'}$ |

三次Hermite插值多项式为：
$$
\begin{array}{l}
{H_3}(x) = {y_0}\left( {1 + 2\frac{{x - {x_0}}}{{{x_1} - {x_0}}}} \right){\left( {\frac{{x - {x_1}}}{{{x_0} - {x_1}}}} \right)^2}\\
 + {y_1}\left( {1 + 2\frac{{x - {x_1}}}{{{x_0} - {x_1}}}} \right){\left( {\frac{{x - {x_0}}}{{{x_1} - {x_0}}}} \right)^2}\\
 + y_0^\prime \left( {x - {x_0}} \right){\left( {\frac{{x - {x_1}}}{{{x_0} - {x_1}}}} \right)^2}\\
 + y_1^\prime \left( {x - {x_1}} \right){\left( {\frac{{x - {x_0}}}{{{x_1} - {x_0}}}} \right)^2}
\end{array}
$$
余项：
$$
R_{3}(x)=\frac{f^{(4)}(\xi)}{4 !}\left(x-x_{0}\right)^{2}\left(x-x_{i}\right)^{2}, \xi \in[a, b]
$$

### 5.4 三点三次带一个导数插值



## 6 分段低次插值

### 6.1 高次插值的龙格现象

龙格现象就是插值多项式不收敛现象，节点(插值多项式的次数)增加不会带来精度的改善，甚至可能增加误差。

### 6.2 分段低次插值

对给定区间 $[a, b]$ 做分割： $a=x_{0}<x_{1}<\ldots<x_{n}=b,$ 在每个小区间 $\left[x_{i}, x_{i+1}\right]$ 上 以 $x_{i}, x_{i+1}$ 为节点作 $f(x)$ 的线性插值：
$$
S_{i}(x)=\frac{x-x_{i+1}}{x_{i}-x_{i+1}} f\left(x_{i}\right)+\frac{x-x_{i}}{x_{i+1}-x_{i}} f\left(x_{i+1}\right), x \in\left[x_{i}, x_{i+1}\right]
$$
把每个小区间上的线性插值函数连起来，就得到了分段线性插值函数 $S(x)$ ，误差公式为：
$$
|f(x)-S(x)| \leq \frac{M_{2}}{8}\left(x_{i}-x_{i+1}\right)^{2}, M_{2}=\max _{a \leq x \leq b}\left|f^{\prime \prime}(x)\right|
$$

### 6.3 分段三次Hermite插值

对给定区间 $[a, b]$ 做分割： $a=x_{0}<x_{1}<\ldots<x_{n}=b,$ 在每个小区间 $\left[x_{i}, x_{i+1}\right]$ 上 以 $x_{i}, x_{i+1}$ 为节点作分段三次Hermite插值:
$$
S_{i}(x)=f\left(x_{i}\right)\left(1-2 \frac{x-x_{i}}{x_{i}-x_{i+1}}\right)\left(\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\right)^{2}\\
+f\left(x_{i+1}\right)\left(1-2 \frac{x-x_{i+1}}{x_{i}-x_{i+1}}\right)\left(\frac{x-x_{i}}{x_{i+1}-x_{i}}\right)^{2} \\
+f^{\prime}\left(x_{i}\right)\left(x-x_{i}\right)\left(\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\right)^{2}\\
+f^{\prime}\left(x_{i+1}\right)\left(x-x_{i+1}\right)\left(\frac{x-x_{i}}{x_{i+1}-x_{i}}\right)^{2}
$$
误差公式为：
$$
|f(x)-S(x)| \leq \frac{h^{4}}{384} \max _{x_{i} \leq x \leq x_{i-1}}\left|f^{(4)}(x)\right|, h=\max _{0 \leq i \leq n-1}\left|x_{i+1}-x_{i}\right|
$$


# 第三章 函数逼近

  

## 1 函数逼近的概念

首先我们可能对函数逼近的概念不太清楚，这里我们先通过一个熟悉的例子来了解一下函数逼近的概念。

现在我们仍然是已知 $x_1...x_N ; y_1...y_N$ 求一个简单易算的近似函数 $P(x) \approx f(x)$ ，之前我们是通过插值的方法来计算 $P(x)$ 但是当：

1. N很大；
2. $y_i$ 本身是测量值，不准确，即 $y_i \ne f(x_i)$ 

我们这时没必要取 $P(x_i) = y_i$ ，而要使得 $P(x_i) - y_i$ **总体上**在某种度量标准下尽可能小 。那逼近误差的常用度量标准有：

1. 一致逼近（太复杂，一般不用）
   $$
   {\left\| {f(x) - y(x)} \right\|_\infty } = \mathop {\max }\limits_{a \le x \le b} \left| {f(x) - y(x)} \right|
   $$

2. **平方逼近**
   $$
   \left\| {f(x) - y(x)} \right\|_2^2 = \int_{\,a}^{\,b} {\rho (x)} {[f(x) - y(x)]^2}dx
   $$

## 2 内积与内积空间

> **定义**：设在区间 (a, b) 上非负函数 $\rho (x)$ ，满足条件：
>
> 1. $\int_{\;a}^{\;b} {|x{|^n}\rho (x)dx} $ 存在 (n=0,1,…)，
>
> 2. 对非负的连续函数 $g(x)$ ，若$\int_{\;a}^{\;b} {g(x)\rho (x)dx = 0} $ ，
>
> 则在(a, b)上 $g(x) \equiv 0$ ，$\rho (x)$ 就称为区间(a, b)上的**权函数**。

---------------

> **定义**：设 $f(x),\;g(x) \in C[a,\;b],\;\rho (x)$ 是[a, b]上的权函数，积分：
> $$
> (f,\;g) = \int_{\;a}^{\;b} {\rho (x)f(x)g(x)dx}
> $$
> 称为函数 $f(x)$ 与 $g(x)$ 在[a, b]上的**内积**。
>
> 满足内积定义的函数空间称为**内积空间**。因此，连续函数空间 $C[a,\;b]$ 上定义了内积就形成一个内积空间。 

---------------------

> **定义**： $f(x) \in C[a,\;b]$ ，量
> $$
> {\left\| {\;f\;} \right\|_2} = \sqrt {\int_{\;a}^{\;b} {\rho (x){f^2}(x)dx} }  = \sqrt {(f,\;f)}
> $$
> 称为 $f(x)$ 的**欧式范数**。

--------------------

> **定理**：对任何 $f,\;g \in C[a,\;b]$ ，下列结论成立
>
> 1. $|(f,\;g)| \le \;{\left\| {{\kern 1pt} f{\kern 1pt} } \right\|_2}{\kern 1pt} {\left\| {{\kern 1pt} {\kern 1pt} g{\kern 1pt} } \right\|_2}$ 
>    此式称为柯西—许瓦兹（Cauchy-Schwarz）不等式
>
> 2. ${\left\| {f + g} \right\|_2} \le \;{\left\| {{\kern 1pt} f{\kern 1pt} } \right\|_{\rm{2}}}{\left\| {{\kern 1pt} g{\kern 1pt} } \right\|_{\rm{2}}}$ 
>    三角不等式
> 3. $\left\| {f + g} \right\|_2^2 + \;\left\| {{\kern 1pt} f - g{\kern 1pt} } \right\|_2^2 = 2(\left\| {{\kern 1pt} f{\kern 1pt} } \right\|_2^2 + \left\| {{\kern 1pt} g{\kern 1pt} } \right\|_2^2)$ 
>    平行四边形不等式

------------------

> **定义**：若 $f(x),\;g(x) \in C[a,\;b]$ 满足
> $$
> (f,\;g) = \int_{\;a}^{\;b} {\rho (x)f(x)g(x)dx = 0}
> $$
> 则称 $f$ 与 $g$ 在[a, b]上带权 $\rho(x)$ 正交，若函数族 ${\varphi _0}(x),\;{\varphi _1}(x),\; \cdots ,\;{\varphi _n}(x), \cdots $ 满足关系：
> $$
> ({\varphi _j},\;{\varphi _k}) = \int_{\;a}^{\;b} {\rho (x){\varphi _j}(x){\varphi _k}(x)dx = \left\{ \begin{array}{l}
> \;0,\quad \quad \quad j \ne k\\
> {A_k} > 0,\quad j = k
> \end{array} \right.}
> $$
> 就称 $ \{\varphi_k \}$ 是[a, b]上带权 $\rho (x)$ 的**正交函数族**；若 ${A_k} \equiv 1$ ，就称之为**标准正交函数族**。

例如： 三角函数族 $1,\;\cos x,\;\sin x,\;\cos 2x,\;\sin 2x,\; \cdots ,$

----------------------

> **定义**：线性无关函数族 ${\varphi _0}(x),\;{\varphi _1}(x),\; \cdots ,\;{\varphi _n}(x), \cdots$ 满足条件：其中任意函数的线性组合${a_0}{\varphi _0}(x) + {a_1}{\varphi _1}(x) +  \cdots  + {a_{n - 1}}{\varphi _{n - 1}}(x) = 0$ 对任意 $x \in [a, b]$ 成立当且仅当 ${a_0} = {a_1} =  \cdots  = {a_{n - 1}} = 0$ 时成立，则称在[a, b]上是**线性无关**的，若函数族中的任何有限个 $\{ {\varphi _k}\} (k = 0,\;1, \cdots )$ 线性无关，则称 $\{\varphi _k\}$为**线性无关函数族**。

例如：$1,\;x, \cdots ,\;{x^n}, \cdots $ 就是[a, b]上线性无关函数族，

----------------------------

> **定理**：判断函数族 $\{\varphi_k\} (k = 0,\;1, \cdots ,\;n - 1)$ 线性无关的充要条件：
>
> ${\varphi _0}(x),\;{\varphi _1}(x), \cdots ,\;{\varphi _{n - 1}}(x)$ 在[a, b]上**线性无关的充要条件**是它的克莱姆（Cramer）行列式 ${G_{n - 1}} \ne 0$ 其中：

$$
{G_{n - 1}} = G({\varphi _0}\;{\varphi _1}, \cdots ,\;{\varphi _{n - 1}}) = \left| {\begin{array}{*{20}{c}}
{({\varphi _0},\;{\varphi _0})}&{({\varphi _0},\;{\varphi _1})}& \cdots &{({\varphi _0},\;{\varphi _{n - 1}})}\\
{({\varphi _1},\;{\varphi _0})}&{({\varphi _1},\;{\varphi _1})}& \cdots &{({\varphi _1},\;{\varphi _{n - 1}})}\\
{ \cdots  \cdots }&{}& \cdots &{}\\
{({\varphi _{n - 1}},{\varphi _0})}&{({\varphi _{n - 1}},\;{\varphi _1})}& \cdots &{({\varphi _{n - 1}},\;{\varphi _{n - 1}})}
\end{array}} \right|
$$


## 3 函数的最佳平方逼近

设函数 $f(x) \in C[a,\;b]$ ，用 $n$ 次多项式 $s(x) = \sum\limits_{k = 0}^n {{a_k}{x^k}} $ 作**最佳平方逼近**，就是要求得以 $a_0^*,\;a_1^*, \cdots ,\;a_n^*$ 为系数的多项式 $s^*(x) = \sum\limits_{k = 0}^n {a_k^*{x^k}} $ 使：
$$
\left\| {f(x) - s^*(x)} \right\|_2^2 = \int_{\;a}^{\;b} {{{[f(x) - s^*(x)]}^2}dx = \mathop {\min }\limits_{s(x) \in {H_n}} \left\| {f(x) - s(x)} \right\|_2^2}
$$
推广到一般的情况，就是对于给定的权函数 $\rho (x)$  ，要求得 $a_k^*\quad (k = 0,\;1, \cdots ,\;n)$ 使得：
$$
\left\| {f(x) - s^*(x)} \right\|_2^2 = \int_{\;a}^{\;b} {\rho (x){{[f(x) - s^*(x)]}^2}dx = \mathop {\min }\limits_{s(x) \in {H_n}} \left\| {f(x) - s(x)} \right\|_2^2}
$$

---------------------

**最佳平方逼近**的提法可以叙述为：求 $a_k^*\quad (k = 0,\;1,\; \cdots ,\;n)$ 使得：
$$
\left\| {f(x) - s^*(x)} \right\|_2^2 = \left\| {f(x) - \sum\limits_{k = 0}^n {a_k^*{\varphi _k}(x)} } \right\|_2^2 = \mathop {\min }\limits_{s(x) \in \Phi } \left\| {f(x) - s(x)} \right\|_2^2
$$
称 $s^*(x) = \sum\limits_{k = 0}^n {a_k^*{\varphi _k}(x)} $ 为 $f(x) \in C[a,\;b]$ 在子集 $\Phi  \subset C[a,\;b]$ 中的最佳平方逼近函数，为了求得 $s^*(x)$ ，这个问题等价于关于 ${a_0},\;{a_1}, \cdots ,\;{a_n}$ 的多元函数：
$$
I({a_0},\;{a_1}, \cdots ,\;{a_n}) = \int_{\;a}^{\;b} {\rho (x){{[f(x) - \sum\limits_{k = 0}^n {{a_k}{\varphi _k}(x)} ]}^2}} dx
$$
的最小值问题。

为了确定参数 ${a_k}\quad (k = 0,\;1,\; \cdots ,\;n)$ ，由多元函数极值存在的必要条件，有：
$$
\frac{{\partial I}}{{\partial {a_k}}} = 2\int_{\;a}^{\;b} {\rho (x)\left[ {\sum\limits_{j = 0}^n {{a_j}{\phi _j}(x) - f(x)} } \right]{\phi _k}(x)dx = 0}\quad (k = 0,\;1,\; \cdots ,\;n)
$$
即有：
$$
\sum\limits_{j = 0}^n {({\varphi _j},\;{\varphi _k}){a_j} = (f,\;{\varphi _k}),\quad (k = 0,\;1, \cdots ,\;n)}
$$
这是关于未知数 ${a_0},\;{a_1}, \cdots ,\;{a_n}$ 的线性代数方程组，称为**法方程** ：
$$
\left[ {\begin{array}{*{20}{c}}
{({\varphi _0},\;{\varphi _0})}&{({\varphi _0},\;{\varphi _1})}& \cdots &{({\varphi _0},\;{\varphi _n})}\\
{({\varphi _1},\;{\varphi _0})}&{({\varphi _1},\;{\varphi _1})}& \cdots &{({\varphi _1},\;{\varphi _n})}\\
 \vdots & \vdots & \vdots & \vdots \\
{({\varphi _n},\;{\varphi _0})}&{({\varphi _n},\;{\varphi _1})}& \cdots &{({\varphi _n},\;{\varphi _n})}
\end{array}} \right]\;\left[ {\begin{array}{*{20}{c}}
{{a_0}}\\
{{a_1}}\\
 \vdots \\
{{a_n}}
\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
{({\varphi _0},\;f)}\\
{({\varphi _1},\;f)}\\
 \vdots \\
{({\varphi _n},\;f)}
\end{array}} \right]
$$
由于 ${\varphi _0},{\varphi _1}, \cdots ,{\varphi _n}$ 线性无关，故系数行列式 $G({\varphi _0},{\varphi _1}, \cdots ,{\varphi _n}) \ne 0$ ，于是方程组有唯一解 ${a_k} = a_k^*, (k = 0,\;1, \cdots ,\;n)$  ，从而得到：
$$
s^*(x) = a_0^*{\phi _0}(x) +  \cdots  + a_n^*{\phi _n}(x)
$$
如果令 $\delta  = f(x) - s^*(x)$ ，由法方程易知 $(f - s^*,\;s^*) = 0$ 则**平方误差**为：
$$
\left\| {{\kern 1pt} \delta {\kern 1pt} } \right\|_2^2 = (f - s^*,\;f - s^*) = (f,\;f) - (s^*,\;f)\\
= \left\| {\;f\;} \right\|_2^2 - \sum\limits_{k = 0}^n {a_k^*({\varphi _k},\;f)}
$$

-----------------

**特例**：若取 $\varphi (x) = {x^k},\;\rho (x) \equiv 1,\;f(x) \in C[0,\;1]$ ，要在 ${{\bf{H}}_n}$ 中求 $n$ 次**最佳平方逼近多项式**：
$$
s……*(x) = a_0^* + a_1^*x +  \cdots  + a_n^*{x^n}
$$
这时：
$$
({\varphi _j},\;{\varphi _k}) = \int_{\;0}^{\;1} {{x^{k + j}}} dx = \frac{1}{{k + j + 1}}
$$

$$
(f,\;{\varphi _k}) = \int_{\;0}^{\;1} {{x^k}f(x)} dx = {d_k}
$$

于是法方程组组的系数矩阵为Hilbert阵：
$$
{\bf{H}} = \left[ {\begin{array}{*{20}{c}}
1&{\frac{1}{2}}& \cdots &{\frac{1}{{n + 1}}}\\
{\frac{1}{2}}&{\frac{1}{3}}& \cdots &{\frac{1}{{n + 2}}}\\
 \vdots & \vdots &{}& \vdots \\
{\frac{1}{{n + 1}}}&{\frac{1}{{n + 2}}}& \cdots &{\frac{1}{{2n + 1}}}
\end{array}} \right]
$$
记 ${\bf{d}} = {({d_0},\;{d_1}, \cdots ,\;{d_n})^T},\;\;{\bf{a}} = {({a_0},\;{a_1}, \cdots ,\;{a_n})^T}$ 则 $H{\bf{a}} = {\bf{d}}$ 的解 ${a_k} = a_k^*\;\;(k = 0,\;1,\; \cdots ,\;n)$ 即为所求。

--------------------------

例题：定义内积 $(f,\;g) = \int_{\;0}^{\;1} {f(x)g(x)dx}$ ，试在 ${H_1} = span\{ 1,\;x\}$ 中寻求对于 $f(x) = \sqrt x $ 的最佳平方逼近元素 $P(x)$ 。（这里实际上要求的是(0, 1)上的一次最佳平方逼近多项式）

解：${d_0} = (f,\;1) = \int_{\;0}^{\;1} {\sqrt x dx = \frac{2}{3},\;\;{d_1} = (f,\;x) = \int_{\;0}^{\;1} {x\sqrt x dx}  = \frac{2}{5}} $ 

得法方程组：
$$
\left[ {\begin{array}{*{20}{c}}
1&{\frac{1}{2}}\\
{\frac{1}{2}}&{\frac{1}{3}}
\end{array}} \right]\;\left[ {\begin{array}{*{20}{c}}
{{a_0}}\\
{{a_1}}
\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
{\frac{2}{3}}\\
{\frac{2}{5}}
\end{array}} \right]
$$
解得 $a_0^* = \frac{4}{{15}},\;a_1^* = \frac{{12}}{{15}}$ ，所求的最佳平方逼近元素为：
$$
P(x) = \frac{4}{{15}} + \frac{{12}}{{15}}x\quad \quad 0 \le x \le 1
$$
平方误差：
$$
\left\| {\;\delta \;} \right\|_2^2 = (f,\;f) - \sum\limits_{k = 0}^1 {a_k^*(f,\;{\varphi _k}) = \int_{\;0}^{\;1} {xdx - \sum\limits_{k = 0}^1 {a_k^*{d_k}} } }\\
 = \frac{1}{2} - \frac{4}{{15}} \times \frac{2}{3} - \frac{{12}}{{15}} \times \frac{2}{5} = 0.002222
$$


## 3 正交多项式

> **定义**：首项系数 $a_k \ne 0$ 的 $n$ 次多项式 ${g_n}(x)$，满足：
> $$
> \int_{\;a}^{\;b} {\rho (x){g_j}(x){g_k}(x)dx = \left\{ \begin{array}{l}
> 0,\quad \quad \quad j \ne k\\
> {A_k} > 0,\quad j = k
> \end{array} \right.} \quad (j,k = 0,\;1, \cdots )
> $$
> 就称多项式序列 ${g_0}(x),\;{g_1}(x), \cdots  \cdots $ 在[a, b]上带权 $\rho (x)$ 正交，并称 ${g_n}(x)$ 是[a, b]上带权 $\rho (x)$ 的 $n$ 次**正交多项式**。



**正交多项式的性质**：

1. $\{ {g_k}(x)\} $ 是线性无关的

2. ${g_k}(x)$ 的k个零点都是实的、相异的，且全部在区间(a,b)内部

3. 最高项系数为1的正交多项式 $\{{g_k}(x)\}$ 中任何相邻三个多项式 ${g_{k - 1}}(x),\;{g_k}(x),\;{g_{k + 1}}(x)$ 存在如下的三项**递推关系**：
   $$
   {g_{k + 1}}(x) = (x - {a_{k + 1}}){g_k}(x) - {b_k}{g_{k - 1}}(x)
   $$
   其中 ${a_k},\;{b_k}$ 都是与 $x$ 无关的常数，且
   $$
   \left\{ {{a_{k + 1}} = \frac{{(x{g_k},{g_k})}}{{({g_k},{g_k})}},\quad {b_0} = 0,\quad {b_k} = \frac{{({g_k},{g_k})}}{{({g_{k - 1}},{g_{k - 1}})}}} \right.,k = 1,2, \cdots
   $$

###  3.1 勒让德多项式

当区间为 $[-1,1],$ 权函数 $\rho(x) \equiv 1$ 时 $,$ 由 $\left\{1, x, \cdots, x^{n}, \cdots\right\}$ 正交化得到的多项式就称为**勒让德多项式**, 并用 $P_{0}(x), P_{1}(x), \cdots, P_{n}(x), \cdots$表示，
$$
\begin{array}{l}P_{0}(x)=1 \\P_{n}(x)=\frac{1}{2^{n} n !} \frac{d^{n}}{d x^{n}}\left\{\left(x^{2}-1\right)^{n}\right\} \quad(n=1,2, \cdots)\end{array}
$$
由于 $\left(x^{2}-1\right)^{n}$ 是 $2n$ 次多项式, 求 $n$ 阶导数后得
$$
P_{n}(x)=\frac{1}{2^{n} n !}(2 n)(2 n-1) \cdots(n+1) x^{n}+a_{n-1} x^{n-1}+\cdots+a_{0}
$$
其中 ${a_n} = \frac{{(2n)\;!}}{{{2^n}{{(n\;!)}^2}}}$ ，然后最高项系数为1的**勒让德多项式**即为：
$$
{\tilde P_n}(x) = \frac{{n\;!}}{{(2n)\;!}}\;\frac{{{d^n}}}{{d{x^n}}}[{({x^2} - 1)^n}]
$$


**勒让德多项式的重要性质**：

1. 正交性
   $$
   \int_{\; - 1}^{\;1} {{P_n}(x){P_m}(x)dx = \left\{ \begin{array}{l}
   0\quad \quad \quad m \ne n\\
   \frac{2}{{2n + 1}}\quad m = n
   \end{array} \right.}
   $$

2. 奇偶性
   $$
   {P_n}( - x) = {( - 1)^n}{P_n}(x)
   $$

3. 在所有最高项系数为1的 $n$ 次多项式中，勒让德多项式 ${{\tilde P}_n}(x)$ 在[-1,1]上与零的平方误差最小。

4. $P_{n}(x)$ 在区间 [-1,1] 内有 $n$ 个不同的实零点。

5. **递推性**
   当 $n \ge 1$ 时，有：
   $$
   (n + 1){P_{n + 1}}(x) = (2n + 1)x{P_n}(x) - n{P_{n - 1}}(x),(n = 1,\;2, \cdots )
   $$
   由 ${P_0}(x) = 1,\;\;{P_1}(x) = x$ ，利用递推关系就可推出：
   $$
   \begin{array}{l}
   {P_2}(x) = \frac{1}{2}(3{x^2} - 1),\quad \quad \quad \quad \;{P_3}(x) = \frac{1}{2}(5{x^3} - 3x)\\
   {P_4}(x) = \frac{1}{8}(35{x^4} - 30{x^2} + 3),\quad  \cdots 
   \end{array}
   $$

### 3.2 切比雪夫多项式

当区间为 $[-1,1],$ 权函数 $\rho(x)=\frac{1}{\sqrt{1-x^{2}}}$ 时, 由序列 $\left\{1, x, \cdots, x^{n}, \cdots\right\}$ 正交化得到的正交多项式即切比雪夫多项式，表示为：
$$
T_{n}(x)=\cos (n \arccos x) \quad|x| \leq 1
$$
若令 $x=\cos \theta, \quad$ 则 $T_{n}(x)=\cos n \theta, \quad 0 \leq \theta \leq \pi$ 



**切比雪夫多项式的性质**：

1. 切比雪夫多项式 $\left\{T_{n}(x)\right\}$ 在区间 [-1,1] 上带权 $\rho(x)=\frac{1}{\sqrt{1-x^{2}}}$ 正交，且

$$
\int_{-1}^{1} \frac{T_{n}(x) T_{m}(x)}{\sqrt{1-x^{2}}} d x=\left\{\begin{array}{ll}0, & n \neq m \\\frac{\pi}{2}, & n=m \neq 0 \\\pi, & n=m=0\end{array}\right.
$$

2. **递推关系**
   $$
   \left\{ \begin{array}{l}
   {T_{n + 1}}(x) = 2x{T_n}(x) - {T_{n - 1}}(x)\quad \quad (n = 1,\;2, \cdots ),\\
   {T_0}(x) = 1,\\
   {T_1}(x) = x.
   \end{array} \right.
   $$
   由递推关系得：
   $$
   \begin{array}{l}
   {T_0}(x) = 1,\quad \quad \quad \quad \quad \quad \;\;{T_1}(x) = x,\\
   {T_2}(x) = 2{x^2} - 1,\quad \quad \quad \quad \;{T_3}(x) = 4{x^3} - 3x,\\
   {T_4}(x) = 8{x^4} - 8{x^2} + 1,\quad \quad {T_5}(x) = 16{x^5} - 20{x^3} + 5x.
   \end{array}
   $$

3. $T_{n}(x)$ 在区间[-1,1] 上有 $n$ 个零点
   $$
   {x_k} = \cos \frac{{2k + 1}}{{2n}}\pi ,\quad k = 0,\;1,\; \cdots ,\;n - 1
   $$

## 4 用正交函数系作最佳平方逼近

若 $\left\{g_{k}(x)\right\}(k=0,1, \cdots, n)$ 是带权 $\rho(x)$ 正交的函数系，即：
$$
({g_k},\;{g_j}) = \int_{\;a}^{\;b} {\rho (x){g_k}(x){g_j}(x)dx = 0\quad \quad (j \ne k)}
$$
那么，由法方程组 $\sum\limits_{k = 0}^n {({g_k},\;{g_j}){a_j} = (f,\;{g_j})} $ 的各个方程可以独立地解得：
$$
a_j^* = \frac{{({g_j},\;f)}}{{({g_j},\;{g_j})}}\quad \quad (j = 0,\;1,\; \cdots ,\;n)
$$
从而得出**最佳平方逼近函数**：
$$
s^*(x) = \sum\limits_{j = 0}^n {\frac{{({g_j},\;f)}}{{({g_j},\;{g_j})}}{g_j}(x)}
$$
这里的每个 $a_{j}^{*}$ 与 $n$ 是无关的，因此对于函数 $f(x) \in C[a, b]$ 与正交基函数系 $g_{0}, g_{1}, \cdots,$ 只要按公式逐个计算出 $a_{j}^{*}(j=0,1,2, \cdots)$ 即可得到一个级数
$$
a_0^*{g_0}(x) + a_1^*{g_1}(x) \cdots
$$
这个级数称为 $f(x)$ 对应于基函数系 $\{ {g_k}(x)\} _0^\infty $ 的**广义Fourier级数**，系数 $a_{k}^{*}$ 称为**广义Fourier系数**，对任意固定的 $n,$ 其部分和 $s_{n}(x)=\sum_{k=0}^{n} a_{k}^{*} g_{k}(x)$ 称为**广义多项式**，就是所求的**最佳平方逼近多项式**。



当 $f(x) \in C[-1,1]$ 时, 可以用勒让德多项式作基函数 $\left\{g_{k}\right\}=\left\{P_{k}(x)\right\},$ 有
$$
s_n^*(x) = a_0^*{P_0}(x) + a_1^*{P_1}(x) +  \cdots  + a_n^*{P_n}(x)
$$
其中：
$$
a_k^* = \frac{{({P_k},\;f)}}{{({P_k},\;{P_k})}} = \frac{{2k + 1}}{2}\int_{\; - 1}^{\;1} {f(x){P_k}(x)dx}
$$
则 $s_{n}^{*}(x)$ 是使 $\left\| {f(x) - \sum\limits_{k = 0}^n {{a_k}{P_k}(x)} } \right\|_2^2$ 最小的最佳平方逼近多项式。这是得平方误差为：
$$
\left\| {{\delta _n}} \right\|_2^2 = \int_{\; - 1}^{\;1} {{{[f(x)]}^2}} dx - \sum\limits_{k = 0}^n {\frac{2}{{2k + 1}}a^*{{\kern 1pt} ^2}}
$$
例题： 求 $f(x)=e^{x}$ 在 [-1,1]上的三次最佳平方逼近多项式以及平方误差，要求用 $\left\{P_{0}, P_{1}, P_{2}, P_{3}\right\}$ 作基函数。

例题： 求 $f(x) = \sqrt x$ 在区间[0,1]上的一次最佳平方逼近多项式



## 5 最小二乘拟合

现在我们仍然是已知 $x_1...x_N ; y_1...y_N$ 求一个简单易算的近似函数 $P(x) \approx f(x)$ ，之前我们是通过插值的方法来计算 $P(x)$ 但是当：

1. N很大；
2. $y_i$ 本身是测量值，不准确，即 $y_i \ne f(x_i)$ 

我们这时没必要取 $P(x_i) = y_i$ ，而要使得 $P(x_i) - y_i$ **总体上**在某种度量标准下尽可能小 。那逼近误差的常用度量标准有：

1. 使$\mathop {\max }\limits_{1 \le i \le N} |P({x_i}) - {y_i}|$ 最小（太复杂）
2. 使$\sum\limits_{i = 1}^N {|P({x_i}) - {y_i}|} $ 最小（不可导，求解困难）
3. 使$\sum\limits_{i = 1}^N {|P({x_i}) - {y_i}{|^2}} $ 最小，标准这个最好



问题一般的提法是：对于给定的数据 $\left(x_{i}, y_{i}\right)(i=1,2, \cdots, N)$, 选取线性无关的函数族 $\varphi_{0}, \varphi_{1}, \cdots, \varphi_{m}$ 及权函数 $\omega(x)$ ，要求在函数类 $\Phi=\operatorname{span}\left\{\varphi_{0}, \varphi_{1}, \cdots, \varphi_{m}\right\}$ 中寻找一个函数：
$$
I = \sum\limits_{i = 1}^N {\omega ({x_i}){{[{y_i} - \phi ({x_i})]}^2}}
$$
达到极小，显然上式是 $m + 1$个变量 ${a_0},\;{a_1}, \cdots ,\;{a_m}$ 的二次函数。这里和前面得内容唯一的不同为将前面的连续的 $f$ 替换为了离散的 $y$ 。 计算过程类似。



对比内积：
$$
(f,\;g) = \left\{ {\;\begin{array}{*{20}{l}}
{\sum\limits_{i = 1}^N {\omega ({x_i})f({x_i})g({x_i})} }(离散型)\\
{\int_{\,a}^{\,b} {\rho (x)f(x)g(x)dx} }（连续型）
\end{array}} \right.
$$
计算法方程组或叫正规方程组 ${a_0}({\varphi _j},\;{\varphi _0}) + {a_1}({\varphi _j},\;{\varphi _1}) +  \cdots  + {a_m}({\varphi _j},\;{\varphi _m}) = ({\varphi _j},\;y) \quad (j = 0,\;{\rm{1}}\; \cdots ,\;m)$  即有：
$$
\left[ {\begin{array}{*{20}{c}}
{({\varphi _0},\;{\varphi _0})}&{({\varphi _0},\;{\varphi _1})}& \cdots &{({\varphi _0},\;{\varphi _m})}\\
{({\varphi _1},\;{\varphi _0})}&{({\varphi _1},\;{\varphi _1})}& \cdots &{({\varphi _1},\;{\varphi _m})}\\
 \vdots & \vdots & \vdots & \vdots \\
{({\varphi _m},\;{\varphi _0})}&{({\varphi _m},\;{\varphi _1})}& \cdots &{({\varphi _m},\;{\phi _m})}
\end{array}} \right]\;\left[ {\begin{array}{*{20}{c}}
{{a_0}}\\
{{a_1}}\\
 \vdots \\
{{a_m}}
\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
{({\varphi _0},\;y)}\\
{({\varphi _1},\;y)}\\
 \vdots \\
{({\varphi _m},\;y)}
\end{array}} \right]
$$
中间的 $a_j$ 为回归系数。**法方程组又可以写成矩阵形式**：
$$
{{\bf{A}}^T}{\bf{A}}\alpha  = {{\bf{A}}^T}{\bf{Y}}
$$
其中：
$$
\mathbf{A}=\left[\begin{array}{cccc}\varphi_{0}\left(x_{1}\right) & \varphi_{1}\left(x_{1}\right) & \vdots & \varphi_{m}\left(x_{1}\right) \\ \varphi_{0}\left(x_{2}\right) & \varphi_{1}\left(x_{2}\right) & \cdots & \varphi_{m}\left(x_{2}\right) \\ \vdots & \vdots & \cdots & \vdots \\ \varphi_{0}\left(x_{N}\right) & \varphi_{1}\left(x_{N}\right) & \cdots & \varphi_{m}\left(x_{N}\right)\end{array}\right]
$$
从而得到函数：
$$
\varphi _{}^*(x) = a_0^*{\varphi _0} + a_1^*{\varphi _1} +  \cdots  + a_m^*{\varphi _m}
$$
最小平方误差为：
$$
{\delta ^2} = \left\| {y - {\varphi ^*}} \right\|_2^2 = (y - {\varphi ^*},\;y - {\varphi ^*}) = \left\| y \right\|_2^2 - \sum\limits_{j = 0}^m {a_j^*({\varphi _j},\;y)}
$$


若取 ${\varphi _0} = 1,\;{\varphi _1} = x, \cdots ,{\varphi _m} = {x^m}$ ，即取 $\{ 1,\;x, \cdots ,\;{x^m}\} $ 为基函数的代数多项式拟合时，相应的法方程组就是
$$
\left[\begin{array}{cccc}\sum_{i=1}^{N} \omega_{i} & \sum_{i=1}^{N} \omega_{i} x_{i} & \cdots & \sum_{i=1}^{N} \omega_{i} x_{i}^{m} \\ \sum_{i=1}^{N} \omega_{i} x_{i} & \sum_{i=1}^{N} \omega_{i} x_{i}^{2} & \cdots & \sum_{i=1}^{N} \omega_{i} x_{i}^{m+1} \\ \vdots & \vdots & \vdots & \vdots \\ \sum_{i=1}^{N} \omega_{i} x_{i}^{m} & \sum_{i=1}^{N} \omega_{i} x_{i}^{m+1} & \cdots & \sum_{i=1}^{N} \omega_{i} x_{i}^{2 m}\end{array}\right]\left[\begin{array}{c}a_{0} \\ a_{1} \\ \vdots \\ a_{m}\end{array}\right]=\left[\begin{array}{c}\sum_{i=1}^{N} \omega_{i} y_{i} \\ \sum_{i=1}^{N} \omega_{i} x_{i} y_{i} \\ \sum_{i=1}^{N} \omega_{i} x_{i}^{m} y_{i}\end{array}\right]
$$
求出法方程组的解即可得到拟合多项式。



例题：用二次多项式以最小二乘拟合表中的数据并计算误差平方

| $x_i$ | -2   | -1   | 0    | 1    | 2    |
| ----- | ---- | ---- | ---- | ---- | ---- |
| $y_i$ | -0.1 | 0.1  | 0.4  | 0.9  | 1.6  |

解：设二次拟合函数为 $y(x) = {a_1} + {a_2}x + {a_3}{x^2}$ ，利用法方程 ${A^T}Aa = {A^T}Y$ 

其中：${\varphi _0}(x) = 1,{\varphi _1}(x) = x,{\varphi _2}(x) = {x^2},$ $a = {({a_1},{a_2},{a_3})^T}$ ， $Y = {( - 0.1,0.1,0.4,0.9,1.6)^T}$ 

$A = \left[ \begin{array}{l}
1\quad \, - 2\quad 4\\
1\,\quad  - 1\quad \,1\\
1\,\quad \;\,0\,\quad 0\\
1\quad \;\;\,1\,\quad 1\\
1\,\quad \;2\,\quad 4
\end{array} \right]$  ${A^T}A = \left[ \begin{array}{l}
5\quad \;0\quad 10\\
0\quad 10\quad 0\\
10\;\;\;0\;\;\;34
\end{array} \right]$  ${A^T}Y = \left[ \begin{array}{l}
2.9\\ 
4.2\\
\;7
\end{array} \right]$ 

$\left[ \begin{array}{l}
5\quad \;0\quad 10\\
0\quad 10\quad 0\\
10\;\;\;0\;\;\;34
\end{array} \right]\;{\kern 1pt} \left[ \begin{array}{l}
{a_1}\\
{a_2}\\
{a_3}
\end{array} \right] = \left[ \begin{array}{l}
2.9\\
4.2\\
\;7
\end{array} \right]$ 得出 $\begin{array}{l}
{a_1} = 0.4086,\\
{a_2} = 0.42,\\
{a_3} = 0.0857
\end{array}$ 

故所求得二次多项式为：$y(x) = 0.4086 + 0.42x + 0.0857{x^2}$ 

误差平方和：${\sigma _2} = {Y^T}(Y - Aa) = 0.00116$ 



# 第四章 数值积分

## 1 数值积分基本概念

对于积分 $I=\int_{a}^{b} f(x) d x$ 采用牛顿——莱布尼兹公式：
$$
\int_a^b {f(x)} dx = F(b) - F(a)
$$
但因大量被积函数找不到用初等函数表示的原函数或 $f(x)$ 是由一张测量数据表给出时，牛顿—莱布尼兹公式则不能直接运用。

### 1.1 数值积分思想

**数值求积公式的基本思想**：$\int_a^b {f(x)dx = (b - a)f(\xi )} $ ——**积分中值定理**

 <img src="https://gitee.com/jchenTech/images/raw/master/img/20201118094835.png" alt="image-20201118094828384" style="zoom: 67%;" />

为了得到 $f(\xi )$ 的值我们则提供一些算法，每种算法相应获得一种求积方法.如 

* 梯形公式：$\int_a^b {f(x)dx \approx \frac{{(b - a)}}{2}} [f(a) + f(b)]$

* 中矩公式：$\int_a^b {f(x)dx \approx } (b - a)f(\frac{{a + b}}{2})$
* 辛普森公式：$\int_{a}^{b} f(x) d x \approx \frac{(b-a)}{6}\left[f(a)+4 f\left(\frac{a+b}{2}\right)+f(b)\right]$ 

一般的，我们取[a,b]内若干个节点 ${x_k}$ 处的高度 $f({x_k})$ 通过加权平均的方法近似的得出平均高度 $f(\xi )$ ，这类求积公式的一般形式：
$$
\int_{a}^{b} f(x) d x \approx \sum_{k=0}^{n} A_{k} f\left(x_{k}\right)
$$
式中 $\mathop x\nolimits_k $ 称为求积节点，$\mathop A\nolimits_k $ 称为求积系数，亦称伴随节点的权。这类求积法通常称为**机械求积法**。   



数值积分有下述三个方面的主要问题：

1. 精确性程度的衡量标准问题；
2. 求积公式的具体构造问题；
3. 余项估计问题（亦即误差估计问题）；

### 1.2 代数精度

如果某个求积公式对于次数不超过m 的多项式均能准确成立，但对于m+1次多项式就不一定准确，则称该求积公式具有m 次代数精度。

欲使求积公式有m 次代数精度，则令它对 $f(x) = 1,x,{x^2} \cdots ,{x^m}$ 都能准确成立：
$$
\sum_{k=0}^{n} A_{k}=b-a \quad \sum_{k=0}^{n} A_{k} x_{k}=\frac{1}{2}\left(b^{2}-a^{2}\right) \quad \ldots . . . \sum_{k=0}^{n} A_{k} x_{k}^{m}=\frac{1}{m+1}\left(b^{m+1}-a^{m+1}\right)
$$

### 1.3 求积公式的构造

试构造两点求积公式：$\int_{\,a}^{\,b} {f(x)dx \approx } {A_0}f(a) + {A_1}f(b)$ 并考察其代数精度。

解  令公式对 $f(x) = 1,\;x$ 准确成立，则有
$$
\left\{ \begin{array}{l}
{A_0} + {A_1} = b - a\\
{A_0}a + {A_1}b = \frac{1}{2}({b^2} - {a^2})
\end{array} \right.
$$
得出：${A_0} = {A_1} = {\textstyle{{b - a} \over 2}}\quad \quad \int_{a}^{b} {f(x)dx \approx } {\textstyle{{b - a} \over 2}}[f(a) + f(b)]$ 

但对 $f(x) = x^2$ 不成立，所以它的代数精度为1。



> **定理**：在区间 $[a, b]$ 上, 对于给定的n+1个互异节点: $a \leq x_{0}<x_{1}<\ldots<x_{n} \leq b$ 总存在求积系数 $A_{0}, A_{1}, \ldots, A_{n},$ 使求积公式至少具有n次代数精度。



### 1.4 插值型求积公式

设给定一组节点 $a \leq x_{0}<x_{1} \cdots<x_{h} \leq b$ 且已知函数 $f(x)$ 在这些节点上的值， 作插值函数 $L_{n}(x)=\sum_{k=0}^{n} f\left(x_{k}\right) l_{k}(x)$ 。由于代数多项式 $L_{n}(x)$ 的原函数是容易求出的，我们取 $I_{n}=\int_{a}^{b} L_{n}(x) dx$ 作为积分 $I=\int_{a}^{b} f(x) dx$ 的近似值，即令：
$$
\int_a^b {f(x)} dx \approx \int_a^b {{L_n}(x)} dx = \sum\limits_{k = 0}^n {{A_k}f({x_k})} 
$$
这样的求积公式称为是**插值型求积公式**。式中求积系数 $\mathop A\nolimits_k $ 通过插值基函数 ${l_k}(x)$ 积分得出 ${A_k} = \int_a^b {{l_k}(x)dx} $ 。

插值型求积公式的**截断误差或余项**为：$$R[f]=I-I_{n}=\int_{a}^{b} \frac{f^{(n+1)}(\xi)}{(n+1) !} \omega_{n+1}(x) d x$$ ，式中 $\xi$ 与变量 $x$ 有关, $\omega_{n+1}(x)=(x-x_{0})(x-x_{1}) \cdots(x-x_{n})$ 



例题：对 $\int_0^3 {f(x)dx} $ 构造一个至少具有三次代数精度的求积公式。

解  具有4个求积节点的插值型求积公式，至少有3次代数精度，如果在[0，3]上取节点为0，1，2，3，则插值型求积公式为：
$$
\int_0^3 {f(x)dx}  \approx {A_0}f(0) + {A_1}f(1) + {A_2}f(2) + {A_3}f(3)
$$
下面求 ${A_k} = \int_a^b {{l_k}(x)dx} \;(k = 0,1,2,3)$ ：
$$
{A_0} = \int_0^3 {\frac{{(x - 1)(x - 2)(x - 3)}}{{(0 - 1)(0 - 2)(0 - 3)}}dx}  = \frac{1}{6}\int_0^3 {({x^3} - 6{x^2} + 11x - 6)dx}  = \frac{3}{8}
$$
同理 ${A_1} = \frac{9}{8},\quad {A_2} = \frac{9}{8},\quad {A_3} = \frac{3}{8}$ ，即有：
$$
\int_0^3 {f(x)dx}  \approx \frac{3}{8}f(0) + \frac{9}{8}f(1) + \frac{9}{8}f(2) + \frac{3}{8}f(3)
$$
只有三次代数精度，将$f(x) = {x^4}$ 代入公式验证，两端不相等

## 2 牛顿-科特斯(Newton-Cotes)公式

当节点等距分布时：${x_k} = a + kh,h = \frac{{b - a}}{n},k = 0,1,...,n$ 

${A_k} = \int_{{x_0}}^{{x_n}} {\prod\limits_{j \ne k} {\frac{{(x - {x_j})}}{{({x_k} - {x_j})}}} } dx$  令 $x = a + t\,h$ 

则：$ {A_k} = \int_{0}^{n} {\prod\limits_{k \ne j} {\frac{{(t - j)h}}{{(k - j)h}}} }  \times hdt = \frac{{(b - a){{( - 1)}^{n - k}}}}{{nk!(n - k)!}}\int_{0}^{n} {\prod\limits_{k \ne j} {(t - j)dt} } $ 

其中 $\frac{{{{( - 1)}^{n - k}}}}{{nk!(n - k)!}}\int_{\,0}^{n} {\prod\limits_{k \ne j} {(t - j)dt} }$ 称为**Cotes系数** $C^{(n)}_k$ ，此时 $ {A_k} = (b-a) C^{(n)}_k$ 。

注意Cotes 系数仅取决于 n 和k，可查表得到。与 $f (x)$ 及区间[a, b]均无关。

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201118121058.png" alt="image-20201118121058800" style="zoom: 67%;" />

当 $n\ge8$ 时，科特斯系数有正有负，不稳定，一般都是用n=1,2,4。

* 当 n=1 时为梯形公式，代数精度=1；
* 当n=2时为辛普森公式，代数精度为3；
* 当n=3时为辛普森3/8公式 代数精度为3
* 当n=4时为科特斯公式或布尔公式， 代数精度为5

> **定理：n 为偶数阶的Newton-Cotes公式至少有 n+1 次代数精度**。

这里展开说明一下：

* n=1： $\quad C_{0}^{(1)}=\frac{1}{2}, \quad C_{1}^{(1)}=\frac{1}{2}$  代数精度=1
  $$
  \int_{a}^{b} {f(x)dx \approx \frac{{b - a}}{2}} [f(a) + f(b)]
  $$

  $$
  R[f] = \int_{a}^{b} {\frac{{f''({\xi _x})}}{{2!}}} (x - a)(x - b)\,dx
  =  - \frac{1}{{12}}{h^3}f''(\xi ),\quad \xi  \in [a,b],h = \frac{{b - a}}{1}
  $$

* n=2：$C_{0}^{(2)}=\frac{1}{6}, C_{1}^{(2)}=\frac{2}{3}, C_{2}^{(2)}=\frac{1}{6}$  代数精度=3
  $$
  \int_{a}^{b} f(x) d x \approx \frac{b-a}{6}\left[f(a)+4 f\left(\frac{a+b}{2}\right)+f(b)\right]
  $$

  $$
  R[f] =  - \frac{1}{{90}}{h^5}{f^{(4)}}(\xi ),\quad \xi  \in (a,b),h = \frac{{b - a}}{2}
  $$

* n=3：辛普森3/8公式 代数精度=3 $R[f] =  - \frac{3}{{80}}{h^5}{f^{(4)}}(\xi )$ 

* n=4：科特斯公式，代数精度=5，$R[f] =  - \frac{8}{{945}}{h^7}{f^{(6)}}(\xi )$ 



例题：用牛顿—柯特斯公式计算积分 $I = \int_0^1 {\frac{{\sin x}}{x}dx} $ 



## 3 复化求积

高次插值有Runge 现象，故采用分段低次插值分段低次合成的 Newton-Cotes 复化求积公式。

### 3.1 复化梯形公式：

$h = \frac{{b - a}}{n},{x_k} = a + kh(k = 0,...,n)$

在每个 $[{x_{k - 1}},{x_k}]$ 上用梯形公式：
$$
\int_{x_{k-1}}^{x_{k}} f(x) d x \approx \frac{x_{k}-x_{k-1}}{2}\left[f\left(x_{k-1}\right)+f\left(x_{k}\right)\right], \quad k=1, \ldots, n
$$
推出：
$$
\int_{a}^{b} f(x) d x \approx \sum_{k=1}^{n} \frac{h}{2}\left[f\left(x_{k-1}\right)+f\left(x_{k}\right)\right]=\frac{h}{2}\left[f(a)+2 \sum_{k=1}^{n-1} f\left(x_{k}\right)+f(b)\right]=T_{n}
$$
**余项**为：
$$
R[f]=\sum_{k=1}^{n}\left[-\frac{h^{3}}{12} f^{\prime \prime}\left(\xi_{k}\right)\right]=-\frac{h^{2}}{12}(b-a) \frac{\sum_{k=1}^{n} f^{\prime \prime}\left(\xi_{k}\right)}{n}=-\frac{h^{2}}{12}(b-a) f^{\prime \prime}(\xi), \quad \xi \in(a, b)
$$

### 3.2 复化辛普森公式：

$h = \frac{{b - a}}{n},{x_k} = a + k\,h\;(k = 0,...,n)$

每个区间中用辛普森公式：
$$
\int_{x_{k}}^{x_{k+1}} f(x) d x \approx \frac{h}{6}\left[f\left(x_{k}\right)+4 f\left(x_{k+\frac{1}{2}}\right)+f\left(x_{k+1}\right)\right]
$$
推出：
$$
\int_{a}^{b} f(x) d x \approx \frac{h}{6}\left[f(a)+4 \sum_{k=0}^{n-1} f\left(x_{k+\frac{1}{2}}\right)+2 \sum_{k=1}^{n-1} f\left(x_{k}\right)+f(b)\right]=S_{n}
$$
![image-20201118164508341](https://gitee.com/jchenTech/images/raw/master/img/20201118164508.png)

**余项**为：
$$
R[f] =  - \frac{{b - a}}{{180}}{\left( {\frac{h}{2}} \right)^4}{f^{(4)}}(\xi )
$$


### 3.3 区间逐次分半求积法

**给定精度 $\varepsilon$，如何取 $n$ ?**

通常采取将区间不断对分的方法，即取 $n = 2^k$ 

将区间逐次分半进行计算（每分一次就进行一次计算），可以用 $T_n$ 与 $T_{2n}$ 来估计误差，利用前后两次计算结果来判断误差的大小的方法，我们通常称作误差的**事后估计法**。

具体方法如下：用 $T_{2n}$ 作为 $I$ 的近似值，则截断误差为 $\frac{1}{3}\left( {{T_{2n}} - {T_n}} \right)$ 若：
$$
\left| {{T_{2n}} - {T_n}} \right| < \varepsilon ' = 3\varepsilon
$$
（ $\varepsilon$ 为计算结果的允许误差），则停止计算，并取 ${T_{2n}}$作为积分的近似值；否则再次分半。

推导得出下列结论：

**对于辛普森公式，若 ${f^{(4)}}(x)$ 在[a，b]上连续且变化不大，有：**
$$
I \approx {S_{2n}} + \frac{1}{{15}}({S_{2n}} - {S_n}) = {S_{2n}} + \frac{1}{{{4^2} - 1}}({S_{2n}} - {S_n})
$$
**对于柯特斯公式，若 ${f^{(6)}}(x)$ 在[a，b]上连续且变化不大，有**
$$
I \approx {C_{2n}} + \frac{1}{{63}}({C_{2n}} - {C_n}) = {C_{2n}} + \frac{1}{{{4^3} - 1}}({C_{2n}} - {C_n})
$$


## 4 龙贝格(Romberg)算法

### 4.1 梯形法的递推化

将积分区间[a, b] n等分，则一共有n+1个分点，按梯形公式计算的近似值 $T_{n}$ 。将求积区间再二分一次，则分点增至2n+1 个，其中老分点n+1个,为避免计算中的重复, $T_{2 n}$ 的式子改造如下 :
$$
{T_{2n}} = \frac{{b - a}}{{4n}}[f(a) + \sum\limits_{k = 1}^{2n - 1} {f(a + k\frac{{b - a}}{{2n}}) + f(b)]}
$$
其中k为偶数时为老分点，为奇数时是新分点，从而推出：
$$
{T_{2n}} = \frac{1}{2}{T_n} + \frac{{b - a}}{{2n}}\sum\limits_{k = 1}^n {f[a + (2k - 1)\frac{{b - a}}{{2n}}]}
$$
为了便于编程，我们通常吧积分区间取等比区间因此，梯形法的递推化公式可以归纳为：
$$
{T_{{2^k}}} = \frac{1}{2}{T_{{2^{k - 1}}}} + \frac{{b - a}}{{{2^k}}}\sum\limits_{i = 1}^{{2^{k - 1}}} {f[a + (2i - 1)\frac{{b - a}}{{{2^k}}}]}
$$

### 4.2 龙贝格Romberg算法

梯形法计算简单但收敛慢，龙贝格算法可以提高收敛速度。龙贝格求积公式也称为逐次分半加速法。它是在梯形公式、辛普森公式和柯特斯公式之间的关系的基础上，构造出一种加速计算积分的方法。

已知对于$\epsilon = 0.5×10^{-6}$ 须将区间对分7次，得到 $T_{128} = 0.9460827$ 这个过程计算了129个点的值。

现在我们考察 $\frac{{I - {T_{2n}}}}{{I - {T_n}}} \approx \frac{1}{4}$ 推出 $I - {T_{2n}} \approx \frac{1}{3}({T_{2n}} - {T_n})$ ，由 $I \approx \frac{{4{T_{2n}} - {T_n}}}{{4 - 1}} = \frac{4}{3}{T_{2n}} - \frac{1}{3}{T_n}$ 计算 $I$ 时只计算了9个点的值，收敛速度提高。
$$
\frac{4}{3}{T_8} - \frac{1}{3}{T_4} = 0.9460833 = S_4
$$
 我们可以进一步推出：
$$
\frac{{4{T_{2n}} - {T_n}}}{{4 - 1}} = {S_n}
$$

$$
\frac{{{4^2}{S_{2n}} - {S_n}}}{{{4^2} - 1}} = {C_n}
$$

$$
\frac{{{4^3}{C_{2n}} - {C_n}}}{{{4^3} - 1}} = {R_n}
$$

分别对应着复化辛普森公式，复化科特斯公式和龙贝格序列。

设以 $T_{0}^{k}$ 表示二分 k次后求得的梯形值，且以 的$T_m^k$ 表示序列 $\{T_0^k\}$ 的m次加速值，则由上面递推公式可得到:
$$
T_m^k(h) = \frac{{{4^m}}}{{{4^m} - 1}}T_{m - 1}^{k + 1} - \frac{1}{{{4^m} - 1}}T_{m - 1}^k\quad(k=1,2,...)
$$
此公式也被称为 **龙贝格求积算法**。



### 4.3 计算步骤

所谓龙贝格算法，就是二分过程中逐步形成T数表的具体方法，其步骤如下：

1. 取 $k=0$， $h=b-a$ ，求 $T(0)=h[f(a)+f(b)] / 2$ 令 1 --> k（ $k$ 记区间 [a,b]的二分数）。

2. 求梯形值 ${T_0}(\frac{{b - a}}{{{2^k}}})$ ，按递推公式
   $$
   T_{{2^k}}^{} = \frac{1}{2}{T_{{2^{k - 1}}}} + \frac{{b - a}}{{{2^k}}}\sum\limits_{i = 1}^{{2^{k - 1}}} {f[a + (2i - 1)\frac{{b - a}}{{{2^k}}}]}
   $$
   计算 $T_0^k$ 。

3. 求加速值，按公式
   $$
   T_m^k(h) = \frac{{{4^m}}}{{{4^m} - 1}}T_{m - 1}^{k + 1}(\frac{h}{2}) - \frac{1}{{{4^m} - 1}}T_{m - 1}^k(h)
   $$
   逐个求出T数表的第k行其余各元素 $T_j^{k - j}$ (j=1,2,…,k）。

4. 若 $\left|T_{k}^{0}-T_{k-1}^{0}\right|<\varepsilon$ (预先给定的精度)，则终止计算，并取 $T_{k}^{(0)} \approx I ;$ 否则令 $k+1 \rightarrow k$ 转第2步继续计算。

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119113417.png" alt="image-20201119113416902" style="zoom: 67%;" />

## 5 高斯型积分

> 定义：选互异节点 ${x_0},{x_1}, \ldots ,{x_n},$ 使插值型求积公式的代数精度为 $2n+1$，则称该求积公式为Gauss型的。称这些节点为Gauss点。

n+1个节点的插值型求积公式**至少**可达到**n**次代数精度，**至多**只能达到**2n+1**次代数精度。

**Gauss点与正交多项式零点的关系**：

一般利用正交多项式来确定Gauss点 ${x_0},{x_1}, \ldots ,{x_n},$ 然后,利用插值原理确定Gauss求积系数：
$$
{A_k} = \int_a^b {\rho (x){l_k}(x)dx}
$$
其中 $l_{k}(x)$ 是关于Gauss点的Lagrange插值基函数，从而得到插值型求积公式：
$$
\int_a^b {\rho (x)f(x)dx}  \approx \sum\limits_{k = 0}^n {{A_k}f({x_k})}
$$
Gauss型求积公式是插值型的，确定Gauss点是关键！



> 定理： $x_{0} \ldots x_{n}$ 为 Gauss 点 $\Leftrightarrow \omega(x)=\prod_{k=0}^{n}\left(x-x_{k}\right)$ 与任意次数不大于 $n$ 的多项式 $P(x)$ （带权）正交。即：$\int_{a}^{b} \rho(x) \omega(x) P(x) d x=0$ 

> 正交多项式族 $\left\{\varphi_{0}, \varphi_{1}, \ldots, \varphi_{n}, \ldots\right\}$ 有性质：任意次数不大于 $n$ 的多项式 $P(x)$ 必与 $\varphi_{n+1}$ 正交。
>
> 因此若取 $\omega(x)$ 为其中的 $\varphi_{n+1},$ 则 $\varphi_{n+1}$ 的零点就是 Gauss 点。



<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119152801.png" alt="image-20201119152801700" style="zoom: 50%;" />

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119152835.png" alt="image-20201119152835776" style="zoom: 33%;" />

### 5.1 高斯——勒让德(Gauss-Legendre)求积公式

积分区间为 [-1,1] 时, 求积公式的代数精度为$2n+1$ 的充要条件是 $\omega(x)$ 在 $[-1,$ 1]上与一切次数不超过 $n$ 的多项式正 交。

由正交多项式的性质可知， $n+1$ 次勒让德多项式 $P_{n+1}(x)$ 就 具有这个性质，所以用 $n+1$ 次勒让德多项式的零点作为节点， 可得高斯型求积公式。
$$
\int_{\; - 1}^{\;1} {f(x)dx \approx \sum\limits_{k = 0}^n {{A_k}f({x_k})} }
$$
该公式通常称为高斯—勒让德（Gauss-Legendre）求积公式。

![image-20201119155019530](https://gitee.com/jchenTech/images/raw/master/img/20201119155019.png)



**若求积区间为[a, b]而不是[-1， 1]怎么办？** 

对于 $\int_{\;a}^{{\kern 1pt} b} {f(x)dx} $ 积分，通过变量替换 $x = \frac{{b - a}}{2}t + \frac{{b + a}}{2}$ 可以化为：
$$
\int_{\;a}^{{\kern 1pt} b} {f(x)dx}  = \frac{{b - a}}{2}\int_{\; - 1}^{\;1} {f(\frac{{b - a}}{2}t + \frac{{b + a}}{2})dt}
$$
就可以用高斯—勒让德公式计算。

### 5.2 高斯——切比雪夫(Gauss-Chebyshev)求积公式

形如 $\int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^{2}}} d x \approx A_{k} \sum_{k=0}^{n} f\left(x_{k}\right)$ 的求积公式, 若其代数精度为2n+1，则称其为高斯——切比雪夫求积公式

![image-20201119160359463](https://gitee.com/jchenTech/images/raw/master/img/20201119160359.png)

一般地，利用n+1次切比雪夫多项式 ${T_{n + 1}}(x)$ 的零点
$$
{x_k} = \cos \frac{{2k + 1}}{{2(n + 1)}}\pi \quad \quad (k = 0,\;1,\; \cdots ,\;n)
$$
可以得到n+1点的Gauss型求积公式：
$$
\int_{\; - 1}^{\;1} {\frac{{f(x)}}{{\sqrt {1 - {x^2}} }}dx \approx \frac{\pi }{{n + 1}}\sum\limits_{k = 0}^n {f(\cos \frac{{2k + 1}}{{2(n + 1)}}\pi )} }
$$

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119161700.png" alt="image-20201119161700779" style="zoom: 33%;" />

Gauss 公式的余项：
$$
R[f] = \int_{\,a}^{\,b} {f(x)dx - \sum\limits_{k = 0}^n {{A_k}f({x_k})} }\\
= \int_{\,a}^{\,b} {f(x)dx - \int_{\,a}^{\,b} {P(x)dx} }  = \int_{\,a}^{\,b} {[f(x) - } P(x)]dx
$$



# 第五章 微分方程求解

## 1 常微分方程的离散化

考虑一阶常微分方程的初值问题
$$
\left\{ {\begin{array}{*{20}{l}}
{\frac{{dy}}{{dx}} = f(x,y)\quad x \in [a,b]}\\
{y(a) = {y_0}}
\end{array}} \right.
$$
只要 $f(x, y)$ 在 $[a, b] \times R^{1}$ 上连续，且关于 $\boldsymbol{y}$ 满足 Lipschitz 条件，即存在与 $x, y$ 无关的常数 $L$ 使 $\left|f\left(x, y_{1}\right)-f\left(x, y_{2}\right)\right| \leq L\left|y_{1}-y_{2}\right|$ 对任意定义在 $[a, b]$ 上的 $y_{1}(x)$ 和$y_{2}(x)$ 都成立，则上述IVP存在唯一解。

本章的任务：计算出解函数 $y(x)$ 在一系列节点 $a=x_{0}<x_{1}<\ldots<x_{n}=b \quad y_{n} \approx y\left(x_{n}\right) \quad(n=1, \ldots, N)$ 处的近似值。



微分方程数值解法，其实是求出方程的解 $y(x)$ 在一系列离散点上的近似值。则微分方程数值解的基本思想是：求解区间和方程离散化。

### 1.1 求解区间离散化

将求解区间 $[a, b]$ 离散化, 是在 $[a, b]$ 上插入一系列的分 点 $\left\{x_{k}\right\},$ 使 $a=x_{0}<x_{1}<\ldots<x_{n}<x_{n+1}<\ldots<x_{N}=b$记 $h_{n}=x_{n+1}-x_{n}(n=0,1, \ldots, N-1)$ 称为步长，一般取 $h_{n}=h$(常数),节点为 $x_{n}=x_{0}+n h \quad(n=0,1,2, \ldots, N), h=\frac{b-a}{N}$称为等步长节点 。

### 1.2 微分方程离散化

1. 差商逼近法
   即是用适当的差商逼近导数值。

2. 数值积分法
   $$
   y({x_m}) - y({x_n}) = \int_{{x_n}}^{{x_m}} {f(x,y(x))dx}
   $$
   然后将上式右端采用数值积分离散化，从而获得原初值问题的一个离散差分格式。

3. Taylor展开法

## 2 欧拉方法

### 2.1 显式欧拉

用**向前差商近似导数**：$y'({x_0}) \approx \frac{{y({x_1}) - y({x_0})}}{h}$ 

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119201956.png" alt="image-20201119201956714" style="zoom: 50%;" />

可以理解为用 $x_0$ 到 $x_1$ 的斜率来近似 $x_0$ 的导数。因此
$$
y({x_1}) \approx y({x_0}) + hy'({x_0}) = {y_0} + hf({x_0},{y_0})
$$
可以表示为：
$$
{y_{n + 1}} = {y_n} + hf({x_n},{y_n})\quad (n = 0,...,N - 1)
$$
<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119202541.png" alt="image-20201119202541414" style="zoom:50%;" />

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119202719.png" alt="image-20201119202718930" style="zoom: 25%;" />

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119202737.png" alt="image-20201119202737697" style="zoom: 25%;" />

从图中可以看出，灰色连续曲线为处置问题的解析解，红色点为数值解，发现随着x的增大，数值解与曲线偏差越来越大，因此显示**欧拉方法的误差是很大的**。

### 2.2 隐式欧拉法

**向后差商近似导数**：$y'({x_1}) \approx \frac{{y({x_1}) - y({x_0})}}{h}$ 

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119203043.png" alt="image-20201119203043541" style="zoom:50%;" />

可以理解为用 $x_0$ 到 $x_1$ 的斜率来近似 $x_1$ 的导数。因此
$$
y\left(x_{1}\right) \approx y_{0}+h f\left(x_{1}, y\left(x_{1}\right)\right)
$$
可以表示为：
$$
y_{n+1}=y_{n}+h f\left(x_{n+1}, y_{n+1}\right) \quad(n=0, \ldots, N-1)
$$
由于未知数 $y_{n+1}$ 同时出现在等式的两边，不能直接得到，因此一般先用显式计算一个初值，再迭代求解。
$$
\left\{ \begin{array}{l}
y_{n + 1}^{(0)} = {y_n} + hf({x_n},{y_n})\\
y_{n + 1}^{(k + 1)} = {y_n} + hf({x_{n + 1}},y_{n + 1}^{(k)})\quad k=0,1,2...
\end{array} \right.
$$
如果迭代过程收敛，则某步后 $y_{n+1}^{(k)}$ 就可以作为 $y_{n+1},$ 从而进行 下一步的计算。

### 2.3 梯形公式——显、隐式两种算法的平均

$$
{y_{n + 1}} = {y_n} + \frac{h}{2}[f({x_n},{y_n}) + f({x_{n + 1}},{y_{n + 1}})]\quad (n = 0,\;...\;,N - 1)
$$

### 2.4 两步欧拉公式

**中心差商近似导数**： $y'({x_1}) \approx \frac{{y({x_2}) - y({x_0})}}{{2h}}$ 

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119204914.png" alt="image-20201119204914306" style="zoom:50%;" />

可以理解为用 $x_0$ 到 $x_2$ 的斜率的一半来近似 $x_1$ 的导数。因此
$$
y({x_2}) \approx y({x_0}) + 2h\,f({x_1},y({x_1}))
$$
可以表示为：
$$
{y_{n + 1}} = {y_{n - 1}} + 2hf({x_n},{y_n})\quad n = 1,...,N - 1
$$
需要两个点 $y_n$ 和 $y_{n-1}$  作为启动点

### 2.5 改进欧拉法

步骤为：

Step 1: 先用**显式欧拉**公式作预测，算出 $\bar{y}_{n+1}=y_{n}+h f\left(x_{n}, y_{n}\right)$ 

Step 2: 再将 $\bar{y}_{n+1}$ 代入**隐式梯形**公式的右边作校正，得到：
$$
y_{n+1}=y_{n}+\frac{h}{2}\left[f\left(x_{n}, y_{n}\right)+f\left(x_{n+1}, \bar{y}_{n+1}\right)\right]
$$

$$
{y_{n + 1}} = {y_n} + \frac{h}{2}\left[ {f({x_n},{y_n}) + f\left( {{x_{n + 1}},{y_n} + hf({x_n},{y_n})} \right)} \right]\quad (n = 0,...,N - 1)
$$

最终表示为：
$$
\begin{array}{l}
{y_p} = {y_n} + hf({x_n},{y_n})\;\\
{y_c} = {y_n} + hf({x_{n + 1}},{y_p})\\
{y_{n + 1}} = \frac{1}{2}({y_p} + {y_c})
\end{array}
$$
此法亦称为预测-校正法，可以证明该算法具有 2 阶精度，比显示欧拉稳定性高，比隐式欧拉迭代过程简单，比梯形公式为单步递推格式。

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119213351.png" alt="image-20201119213351871" style="zoom:25%;" />

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119213408.png" alt="image-20201119213408411" style="zoom: 33%;" />

从表和图可以看出，改进的Euler法的精度提高了不少。

### 2.6 局部截断误差

> 定义：在假设 $y_n = y(x_n)$ 情况下，即第n 步计算是精确的前提下，考虑的截断误差 $T_{n+1}= y(x_{n+1}) - y_{n+1} $ 称为**局部截断误差**

> 定义：若某算法的局部截断误差为O(hp+1)，则称该算法有p 阶精度。

一元函数在点 $x_{k}$ 处的泰勒展开式为：

$$
f(x)=f\left(x_{k}\right)+\left(x-x_{k}\right) f^{\prime}\left(x_{k}\right)+\frac{1}{2 !}\left(x-x_{k}\right)^{2} f^{\prime \prime}\left(x_{k}\right)+o^{n}
$$
二元函数在点 $\left(x_{k}, y_{k}\right)$ 处的泰勒展开式为：
$$
\begin{array}{c}f(x, y)=f\left(x_{k}, y_{k}\right)+\left(x-x_{k}\right) f_{x}^{\prime}\left(x_{k}, y_{k}\right)+\left(y-y_{k}\right) f_{y}^{\prime}\left(x_{k}, y_{k}\right) \\+\frac{1}{2 !}\left(x-x_{k}\right)^{2} f_{x x}^{\prime \prime}\left(x_{k}, y_{k}\right)+\frac{1}{2 !}\left(x-x_{k}\right)\left(y-y_{k}\right) f_{x y}^{\prime \prime}\left(x_{k}, y_{k}\right) \\+\frac{1}{2 !}\left(x-x_{k}\right)\left(y-y_{k}\right) f_{y x}^{\prime \prime}\left(x_{k}, y_{k}\right)+\frac{1}{2 !}\left(y-y_{k}\right)^{2} f_{y y}^{\prime \prime}\left(x_{k}, y_{k}\right) \\+o^{n}\end{array}
$$

**求局部截断误差的步骤** :

1) 作局部化假设，即设 $y_{n}=y(x_{n})$;

2) 将差分解 $y_{n+1}$ 在 $x_n$ 处展开

3) 将准确解 $y(x_{n+1})$ 在 $x_n$ 处做泰勒展开;

4) 比较 $T_{n+1}=y\left(x_{n+1}\right)-y_{n+1}$



欧拉法的局部截断误差：
$$
{T_{n + 1}} = y({x_{n + 1}}) - {y_{n + 1}} = [y({x_n}) + hy'({x_n}) + {\textstyle{{{h^2}} \over 2}}y''({x_n}) + O({h^3})] - [{y_n} + hf({x_n},{y_n})]\\
= {\textstyle{{{h^2}} \over 2}}y''({x_n}) + O({h^3})
$$
因此欧拉法具有1阶精度

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119221657.png" alt="img" style="zoom: 50%;" />

## 3 龙格—库塔法

**建立高精度的单步递推格式。**

基于改进的欧拉法可以写成：
$$
\begin{array}{*{20}{l}}
{{y_{n + 1}}}&{ = \quad {y_n} + h\left[ {\frac{1}{2}{K_1} + \frac{1}{2}{K_2}} \right]}\\
{{K_1}}&{ = \quad f({x_n},{y_n})}\\
{{K_2}}&{ = \quad f({x_n} + h,\,{y_n} + h{K_1})}
\end{array}
$$
显然， $k_1$ , $k_2$ 是在点 $x_n$, $x_{n+1}$ 处的斜率，但是斜率一定取平均值吗？而步长一定是一个h吗？在区间内多取几个点将他们的斜率加权平均作为平均斜率这样可能能构造出精度更高的计算公式，这就是龙格库塔的思想。

基于这点，将改进欧拉法推广为：
$$
\begin{array}{*{20}{l}}
{{y_{n + 1}}}&{ = \quad {y_n} + h\left[ {\lambda_1{K_1} + \lambda_2{K_2}} \right]} \quad\lambda_1+\lambda_2=1\\
{{K_1}}&{ = \quad f({x_n},{y_n})}\\
{{K_2}}&{ = \quad f({x_n} + ph,{y_n} + ph{K_1})} \quad 0 < p \le 1
\end{array}
$$
首先希望能确定系数 $\lambda_{1} 、 \lambda_{2} 、 p,$ 使得到的算法格式有2阶 精度，即在 $y_{n}=y\left(x_{n}\right)$ 的前提假设下，使得
$$
{T_{n + 1}} = y({x_{n + 1}}) - {y_{n + 1}} = O({h^3})
$$
具体推导为：

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201119224441.png" alt="image-20201119224440882" style="zoom: 33%;" />

### 3.1 龙格——库塔法的一般形式

$$
\begin{array}{*{20}{l}}
y_{n+1}=y_{n}+h \sum_{i=1}^{L} \lambda_{i} k_{i}\\
k_{1}=f\left(x_{n}, y_{n}\right)\\
k_{2}=f\left(x_{n}+c_{2} h, y_{n}+c_{2} h k_{1}\right)\\
k_{3}=f\left(x_{n}+c_{3} h, y_{n}+c_{3} h\left(a_{31} k_{1}+a_{32} k_{2}\right)\right)\\
\quad \cdots \cdots \cdots \cdots \cdots\\
k_{i}=f\left(x_{n}+c_{i} h, y_{n}+c_{i} h \sum_{j=1}^{i-1} a_{i j} k_{j}\right) \quad i=2,3, \cdots, L\\
\end{array}
$$

其中 $\sum_{i=1}^{L} \lambda_{i}=1, c_{i} \leq 1, \sum_{j=1}^{i-1} a_{i j}=1$ 均为待定系数，确定这些系数的步骤与前面相似。



最常用为四级**4阶经典龙格-库塔法**，简称RK方法。
$$
\begin{array}{*{20}{l}}
{{y_{n + 1}}}& = &{{y_n} + {\textstyle{h \over 6}}({K_1} + 2{K_2} + 2{K_3} + {K_4})}\\
{{K_1}}& = &{f({x_n},{y_n})}\\
{{K_2}}& = &{f({x_n} + {\textstyle{h \over 2}},{y_n} + {\textstyle{h \over 2}}{K_1})}\\
{{K_3}}& = &{f({x_n} + {\textstyle{h \over 2}},{y_n} + {\textstyle{h \over 2}}{K_2})}\\
{{K_4}}& = &{f({x_n} + h,{y_n} + h{K_3})}
\end{array}
$$





## 4 收敛性与稳定性

### 4.1 收敛性

1. 判断显式单步格式的收敛性，归结为验证增量函数 $\varphi$ 是否满足Lipschitz 条件。
2. 单步格式的整体截断误差由初值误差及局部截断误差决定，整体截断误差比局部截断误差的阶数**低一阶**。
3. 要构造高精度的计算方法，只需设法**提高局部截断误差的阶**即可。

### 4.2 稳定性

> 定义：若某算法在计算过程中任一步产生的误差在以后的计算中都逐步衰减，则称该算法是绝对稳定的

当步长取为 $h$ 时，并假设只在初值产生误差 $\varepsilon_{0}=y_{0}-\bar{y}_{0},$ 则若此误差以后逐步衰减，就称该 算法相对于 $\bar{h}=\lambda h$ 绝对稳定， $\bar{h}$ 的全体构成绝对稳定区域。 我们称算法 A 比算法B 稳定，就是指 A 的绝对稳定区域比 B 的大。

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201120115743.png" alt="image-20201120115743250" style="zoom: 33%;" />

# 第六章 线性方程组求解

 

## 1 向量与矩阵范数

### 1.1 向量范数

> 定义：如果向量 $X \in R^{n}$ 的某个实值函数 $N(X)=\|X\|$ 满足条件
>
> 1. $\left\| X \right\| \ge 0$  ($\left\| X \right\| = 0$ 当且仅当 $X=0$) **正定性**
> 2. $\left\| {\alpha X} \right\| = \left| \alpha  \right|\left\| X \right\|,\forall \alpha  \in R$     **齐次性**
> 3. $\left\| {X + Y} \right\| \le \left\| X \right\| + \left\| Y \right\|$       **三角不等性**
>
> 则称 $N(X)$ 是向量 $X$ 的范数。

 几种常用的向量范数：

1. $\infty$ -范数（是大范数） ${\left\| X \right\|_\infty } = \mathop {\max }\limits_{1 \le i \le n} \left| {{x_i}} \right|$
2. 1 一范数 ${\left\| X \right\|_1} = \sum\limits_{i = 1}^n {\left| {{x_i}} \right|} $ 
3. 2 一范数（长度） ${\left\| X \right\|_2} = {\left( {\sum\limits_{i = 1}^n {x_i^2} } \right)^{1/2}}$
4. $p$ 一范数 ${\left\| X \right\|_p} = {(\sum\limits_{i = 1}^n {{{\left| {{x_i}} \right|}^p}} )^{1/p}}$ 



### 1.2 矩阵范数

> 定义： $R^{m \times n}$ 空间的**矩阵范数** $\|\cdot\|$ 对任意 $A, B \in R^{m \times n}$ 满足:
>
> 1. $\|A\| \geq 0 ;\|A\|=0 \Leftrightarrow A=0$ (正定性)
>
> 2. $\|\alpha A\|=|\alpha| \cdot\|A\|$ 对任意 $\alpha \in C$ (齐次性 )
>
> 3. $\|A+B\| \leq\|A\|+\|B\|$ (三角不等式)
>
> 4. $\|A B\| \leq\|A\| \cdot\|B\|$ （相容  当 $m=n$ 时 ）

常用的矩阵范数：

1. **Frobenius 范数**：$||A|{|_F} = \sqrt {\sum\limits_{i = 1}^n {\sum\limits_{j = 1}^n {|{a_{ij}}{|^2}} } } $ ——向量 $||\cdot||_2$ 的直接推广。即矩阵元素绝对值的平方和再开平方。对方阵  以$\vec{x} \in R^{n}$及 $\mathord{\buildrel{\lower3pt\hbox{$\scriptscriptstyle\rightharpoonup$}} 
   \over x}  \in {R^n}$ 有 $\|A \vec{x}\|_{2} \leq\|A\|_{F} \cdot\|\vec{x}\|_{2}$ 

2. **算子范数**：由向量范数 $|| \cdot ||_p$ 导出关于矩阵 $A\in R^{n \times n}$ 的 p 范数:
   $$
   \|A\|_{p}=\max _{\bar{x} \neq \overline{0}} \frac{\|A \vec{x}\|_{p}}{\|\vec{x}\|_{p}}=\max _{\|\bar{x}\|_{p}=1}\|A \vec{x}\|_{p} \rightarrow \|A \vec{x}\|_{p} \leq\|A\|_{p}\|\vec{x}\|_{p}
   $$
   特别有：

   * $||A|{|_\infty } = \max \limits_{1 \le i \le n} \sum\limits_{j = 1}^n {|{a_{ij}}|} $   行和范数，即所有矩阵行向量绝对值之和的最大值
   * $||A|{|_1} = \max \limits_{1 \le j \le n} \sum\limits_{i = 1}^n {|{a_{ij}}|} $   列和范数，即所有矩阵列向量绝对值之和的最大值
   * $\|A\|_{2}=\sqrt{\lambda_{\max }\left(A^{T} A\right)}$     谱范数，矩阵 $A^T A$ 的最大特征根



### 2 高斯消元法

求解：$A \vec{x}=\vec{b}$ 

> 思路：首先将A化为上三角阵，再回代求解

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201120170935.png" alt="image-20201120170935515" style="zoom: 50%;" />

在以上的高斯消元法中，消元能进行的条件是主元素（即主对角线上的元素）不能等于0。但是在计算机程序实现的过程中，还需要考虑其他因素，因为计算机内部无法存储无限小数，必然会有舍入误差，因此有时虽然a(i,i)不等于0，但是绝对值|a(i,i)|很小，这时计算过程的舍入误差会导致消去法数值不稳定，以致结果不可靠。

## 3 选主元消去法

### 3.1 列主元消去法

列主元高斯消元法的计算原理与高斯消元法的原理大致相同，只是在每一次消元时要先选择以哪一行元素作为标准进行消元，列主元高斯消元法选择的是以绝对值最大的那一行作为标准行来进行消元

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201120174542.png" alt="image-20201120174542196" style="zoom: 33%;" />

## 4 三角分解法

三角分解法亦称因子分解法，由消元法演变而来的解线性方程组的一类方法。设方程组的矩阵形式为 $Ax=b$，三角分解法就是将系数矩阵 $A$ 分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 之积：$A=LU$，然后依次解两个三角形方程组 $Ly=b$ 和 $Ux=y$ ，而得到原方程组的解。

### 4.1 高斯消元法的矩阵形式

由高斯消去法可知，每一次消元操作，都可以看做是在 $A$ 的左边乘了一个矩阵，这个矩阵可以将某一行乘一个数并加到另一行。所以高斯消去法可以看成是下面的形式：
$$
A=L_{1}^{-1} L_{2}^{-1} \ldots L_{n-1}^{-1} A^{(n)}=L U
$$
![image-20201120194203600](https://gitee.com/jchenTech/images/raw/master/img/20201121145337.png)

因为第k次消元时, 第k个方程不会变, 编号大于k的方程才会变, 所以所有 $L_{i}^{(-1)}$ 的乘积 $L$ 是一个单位下三角矩阵。矩阵 $U$ 就是我们高斯消去法最终得到的系数矩阵, 所以 $U$ 是一个上三角矩阵。

> 定理1： 对任意矩阵 $A \in R^{n \times n}(n \geq 2),$ 若A的各阶顺序主子式均不为零，则A有唯一的LU分解

### 4.2 道立特分解法

计算步骤：

1. 对于列 $j=1,...,n$ $u_{1j}=a_{1j}$；$l_{j1}=a_{j1}/u_{11}$ 
2. 对于行$i = 2,...,n-1$计算：

$$
\begin{array}{l}
{u_{ij}} = {a_{ij}} - \sum\limits_{k = 1}^{i - 1} {{l_{ik}}} {u_{kj}}\\
{l_{ji}} = ({a_{ji}} - \sum\limits_{k = 1}^{i - 1} {{l_{jk}}{u_{ki}})} /{u_{ii}}
\end{array}
$$

3. ${u_{nn}} = {a_{nn}} - \sum\limits_{k = 1}^{n - 1} {{l_{nk}}{u_{kn}}} $ 

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201120200721.png" alt="image-20201120200721780" style="zoom:50%;" />

### 4.3 平方根法

——**对称正定矩阵**的分解法

> 定义：一个矩阵 $A=\left(a_{i j}\right)_{n \times n}$ 称为对称阵, 如果 $a_{i j}=a_{j i}$ 。

> 定义： 一个矩阵 $A$ 称为正定阵, 如果 $\bar{x}^{T} A \bar{x}>0$ 对任意非零向量 x 都成立。

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201120205041.png" alt="image-20201120205040964" style="zoom:50%;" />

### 4.4 追赶法解三对角方程组

$$
\left[ {\begin{array}{*{20}{c}}
{{b_1}}&{{c_1}}&{}&{}&{}\\
{{a_2}}&{{b_2}}&{{c_2}}&{}&{}\\
{}&{}&{}&{}&{}\\
{}&{}&{{a_{n - 1}}}&{{b_{n - 1}}}&{{c_{n - 1}}}\\
{}&{}&{}&{{a_n}}&{{b_n}}
\end{array}} \right]\;\left[ {\begin{array}{*{20}{c}}
{{x_1}}\\
{{x_2}}\\
{}\\
{}\\
{{x_n}}
\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
{{f_1}}\\
{{f_2}}\\
{}\\
{}\\
{{f_n}}
\end{array}} \right]
$$

> 定理：若 A 为**对角占优**的三对角阵，且满足 $|{b_1}| > |{c_1}| > 0,|{b_n}| > |{a_n}| > 0,{a_i} \ne 0,{c_i} \ne 0$ ，则追赶法可解以 A 为系数矩阵的方程组。

有两种方法，一种是对做增广矩阵做高斯消元，每行除以对角线上元素，使得对角线元素为1，然后得到一个上三角矩阵，最后求解。

另外一种方法为对A做Crout分解，然后追赶求解：

<img src="https://gitee.com/jchenTech/images/raw/master/img/20201120214119.png" alt="image-20201120214119439" style="zoom:50%;" />

## 5 线性方程组的误差分析

## 6 解线性方程组的迭代法

 